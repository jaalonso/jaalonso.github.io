<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
 <HEAD>
  <TITLE>wxMaxima HTML export</TITLE>
  <META NAME="generator" CONTENT="wxMaxima">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
  <STYLE TYPE="text/css">
body {
  font-family: Sans;
  background-color: rgb(255,255,255);
}
.input {
  color: rgb(0,0,255);
}
.comment {
  color: rgb(0,0,0);
  background-color: rgb(173,216,230);
  padding: 2mm;
}
.image {
  color: rgb(0,0,0);
  padding: 2mm;
}
.section {
  color: rgb(0,0,0);
  font-weight: bold;
  font-style: italic;
  font-size: 1.5em;
  padding: 2mm;
}
.subsect {
  color: rgb(0,0,0);
  font-weight: bold;
  font-size: 1.2em;
  padding: 2mm;
}
.title {
  color: rgb(0,0,0);
  font-weight: bold;
  text-decoration: underline;
  font-size: 2em;
  padding: 2mm;
}
.prompt {
  color: rgb(255,0,0);
}
  </STYLE>
 </HEAD>
 <BODY>

<!---------------------------------------------------------->
<!--          Created with wxMaxima version 0.8.4         -->
<!---------------------------------------------------------->


<!-- Title cell -->


<P CLASS="title">
Tema CS5: Programación<BR>
(Soluciones de ejercicios propuestos)
</P>


<!-- Section cell -->


<P CLASS="section">
 1 Ejercicio 1
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.1. Definir la función tangente tal que tangente(f,a) es la ecuación <BR>
de la tangente a la función f en el punto de abscisa a. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;(%i1) (f(x):=x^3, tangente(f,2));<BR>
&nbsp;&nbsp;&nbsp;(%o1) y=12*(x-2)+8
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i1) 
  </SPAN>
  <SPAN CLASS="input">
tangente(f,a) := block ([m],<BR>
&nbsp;&nbsp;&nbsp;m : at(diff(f(x),x),x=a),<BR>
&nbsp;&nbsp;&nbsp;y = ratsimp(f(a)+m*(x-a)))$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i2) 
  </SPAN>
  <SPAN CLASS="input">
(f(x):=x^3, tangente(f,2));
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_0.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.2. Calcular la tangente a f(x)=ln(tan(|x|) en el punto de abscisa<BR>
-pi/12.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i3) 
  </SPAN>
  <SPAN CLASS="input">
(f(x)=ln(tan(abs(x))), tangente(f,-%pi/12));
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_1.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 2 Ejercicio 2
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.1. Definir el procedimiento signosTrinomio tal que <BR>
signosTrinomio(a,b,c) es la tabla de la variación de los signos del trinomio <BR>
ax^2+bx+c. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;(%i1) signosTrinomio(1,-2,1);<BR>
&nbsp;&nbsp;&nbsp;(%o1) [[[-inf,1],+],[1,0],[[1,inf],+]]<BR>
&nbsp;&nbsp;&nbsp;(%i2) signosTrinomio(-1,2,-1);<BR>
&nbsp;&nbsp;&nbsp;(%o2) [[[-inf,1],-],[1,0],[[1,inf],-]]<BR>
&nbsp;&nbsp;&nbsp;(%i3) signosTrinomio(1,-3,2);<BR>
&nbsp;&nbsp;&nbsp;(%o3) [[[-inf,1],+],[1,0],[[1,2],-],[2,0],[[2,inf],+]]<BR>
&nbsp;&nbsp;&nbsp;(%i4) signosTrinomio(-1,3,-2);<BR>
&nbsp;&nbsp;&nbsp;(%o4) [[[-inf,2],-],[2,0],[[2,1],+],[1,0],[[1,inf],-]]<BR>
&nbsp;&nbsp;&nbsp;(%i5) signosTrinomio(1,0,1);<BR>
&nbsp;&nbsp;&nbsp;(%o5) [[[-inf,inf],+]]<BR>
&nbsp;&nbsp;&nbsp;(%i6) signosTrinomio(-1,0,-1);<BR>
&nbsp;&nbsp;&nbsp;(%o6) [[[-inf,inf],-]]<BR>
Se supone que a es distinto de cero.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i4) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(a,b,c) := block ([d : b^2-4*a*c,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e : -b/(2*a),<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x1,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x2],<BR>
&nbsp;&nbsp;&nbsp;x1 : (-b-sqrt(d))/(2*a),<BR>
&nbsp;&nbsp;&nbsp;x2 : (-b+sqrt(d))/(2*a),<BR>
&nbsp;&nbsp;&nbsp;if d=0 then if a>0 then [[[minf,e],"+"],[e,0],[[e,inf],"+"]]<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else  [[[minf,e],"-"],[e,0],[[e,inf],"-"]] <BR>
&nbsp;&nbsp;&nbsp;elseif d>0  then if a>0 then [[[minf,x1],"+"],[x1,0],[[x1,x2],"-"],[x2,0],[[x2,inf],"+"]]     <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else [[[minf,x1],"-"],[x1,0],[[x1,x2],"+"],[x2,0],[[x2,inf],"-"]]<BR>
&nbsp;<BR>
&nbsp;&nbsp;&nbsp;else if a>0 then [[[minf,inf],"+"]]  <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else [[[minf,inf],"-"]])$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i5) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(1,-2,1);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_2.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i6) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(-1,2,-1);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_3.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i7) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(1,-3,2);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_4.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i8) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(-1,3,-2);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_5.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i9) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(1,0,1);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_6.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i10) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(-1,0,-1);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_7.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.2. Calcular la tabla de la variación de los signos del trinomio<BR>
-6x^2-3x+14/3
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i11) 
  </SPAN>
  <SPAN CLASS="input">
signosTrinomio(-6,-3,14/3);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_8.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 3 Ejercicio 3
</P>


<!-- Text cell -->


<P CLASS="comment">
Se lanza un dado cúbico equilibrado hasta que se obtiene la cara 6 por primera <BR>
vez. Se designa por X la variable aleatorio que cuenta el número de lanzamientos<BR>
efectuados. Se dice que X es el tiempo de espera del primer 6.
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3.1. Definir el procedimiento X() que simule una serie de lanzamientos<BR>
del dado y devuelva el número de lanzamientos realizados para obtener el 6 por <BR>
primera vez.
</P>


<!-- Text cell -->


<P CLASS="comment">
Solución recursiva
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i12) 
  </SPAN>
  <SPAN CLASS="input">
X() := Xaux(1)$<BR>
Xaux(n) :=  if 1+random(6)=6 then n else Xaux(n+1)$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Solución iterativa
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i14) 
  </SPAN>
  <SPAN CLASS="input">
X() := <BR>
&nbsp;&nbsp;&nbsp;for cuenta:0 do<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if 1+random(6) = 6 then return(cuenta))$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3.2. Con la ayuda del bucle for, definir el procedimiento <BR>
simulacion(n) que simule una serie de n lanzamientos y devuelva la lista<BR>
de frecuencia de los eventos [X=i] para 1 <= i <= 60. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;(%i1) simulacion(1000);<BR>
&nbsp;&nbsp;&nbsp;(%o1) [0,145,115,104,88,61,65,53,51,50,40,28,30,29,27,13,21,18,10,6,8,4,9,3,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5,1,2,4,3,1,0,1,0,0,1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,0,0]
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i15) 
  </SPAN>
  <SPAN CLASS="input">
simulacion(n) := block ([i],<BR>
&nbsp;&nbsp;&nbsp;remarray(X),<BR>
&nbsp;&nbsp;&nbsp;array(X,60),<BR>
&nbsp;&nbsp;&nbsp;fillarray(X,makelist(0,i,1,60)),<BR>
&nbsp;&nbsp;&nbsp;for a:1 thru  n do <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(i : X(),<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X[i] : X[i]+1),<BR>
&nbsp;&nbsp;&nbsp;listarray(X))$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i16) 
  </SPAN>
  <SPAN CLASS="input">
simulacion(1000);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_9.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3. Definir la función media tal que media(n) es el valor medio de X en<BR>
n lanzamientos. Calcular tres veces media(1000).
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i17) 
  </SPAN>
  <SPAN CLASS="input">
media(n) := <BR>
&nbsp;&nbsp;&nbsp;(simulacion(n),<BR>
&nbsp;&nbsp;&nbsp;&nbsp;float(sum (X[i]*i,i,0,60)/n))$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i18) 
  </SPAN>
  <SPAN CLASS="input">
media(100); media(100); media(100);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_10.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 4 Ejercicio 4
</P>


<!-- Text cell -->


<P CLASS="comment">
La conjetura de Goldbach afirma que todo número natural par mayor que 3 se puede<BR>
escribir como la suma de dos números primos. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;4 = 2 + 2, 20 = 3 + 17, 50 = 3 + 47
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.1. Definir la función goldbach tal que goldbach(n) es una <BR>
descomposición de n como suma de dos números primos. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;(%i1) goldbach(20);<BR>
&nbsp;&nbsp;&nbsp;(%o1) [3,17]<BR>
Indicación: Iterar los primos desde x=2 hasta n/1 hasta que n-x sea primo.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i21) 
  </SPAN>
  <SPAN CLASS="input">
goldbach(n) := block ([x],<BR>
&nbsp;&nbsp;&nbsp;for x:2 next next_prime(x) thru n/2 do<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if primep(n-x) then return([x,n-x]))$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.2. Descomponer 2010 como suma de dos primos.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i22) 
  </SPAN>
  <SPAN CLASS="input">
goldbach(2010);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_11.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.3. Definir la función goldbachTodas tal que goldbachTodas(n) es la <BR>
lista de todas las descomposiciones de n como suma de dos números primos x e y <BR>
con x<=y. Por ejemplo,<BR>
&nbsp;&nbsp;&nbsp;(%i1) goldbachTodas(20);<BR>
&nbsp;&nbsp;&nbsp;(%o1) [[7,13],[3,17]]
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i23) 
  </SPAN>
  <SPAN CLASS="input">
goldbachTodas (n) := block ([todas:[]],<BR>
&nbsp;&nbsp;&nbsp;for x:2 thru n/2 do<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if primep(x) and primep(n-x) then todas : cons([x,n-x],todas),<BR>
&nbsp;&nbsp;&nbsp;todas)$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i24) 
  </SPAN>
  <SPAN CLASS="input">
goldbachTodas(20);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_12.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.4. Calcular el número de descomposiciones de 2010 como suma de <BR>
dos primos.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i25) 
  </SPAN>
  <SPAN CLASS="input">
length(goldbachTodas(2010));
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS5_ej_sol_img/tema_CS5_ej_sol_13.png">
</P>

 <HR>
 <SMALL> Created with <A HREF="http://wxmaxima.sourceforge.net/">wxMaxima</A>.</SMALL>

 </BODY>
</HTML>
