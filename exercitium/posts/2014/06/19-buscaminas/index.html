<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Buscaminas | Exercitium</title>
<link href="../../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<link href="../../../../assets/css/extras.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="es" href="../../../../rss.xml">
<link rel="canonical" href="https://jaalonso.github.io/exercitium/posts/2014/06/19-buscaminas/">
<link rel="icon" href="../../../../favicon.png" sizes="48x48">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jaalonso.github.io/exercitium/images/exercitium.jpg">
<meta name="twitter:title" content="Buscaminas | Exercitium">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<meta name="author" content="José A. Alonso">
<link rel="prev" href="../18-seleccion_con_fallo/" title="Selección hasta el primero que falla inclusive" type="text/html">
<link rel="next" href="../20-mayor_sucesion_3n%2B1/" title="Mayor sucesión del problema 3n+1" type="text/html">
<meta property="og:site_name" content="Exercitium">
<meta property="og:title" content="Buscaminas">
<meta property="og:url" content="https://jaalonso.github.io/exercitium/posts/2014/06/19-buscaminas/">
<meta property="og:description" content="El buscaminas es un juego cuyo objetivo es despejar un campo de minas sin detonar ninguna.
El campo de minas se representa mediante un cuadrado con NxN casillas. Algunas casillas tienen un número, est">
<meta property="og:image" content="https://jaalonso.github.io/exercitium/images/exercitium.jpg">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-06-19T06:00:00+02:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@Jose_A_Alonso">
<meta name="twitter:creator" content="@Jose_A_Alonso">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../../../" title="Exercitium" rel="home">

        <span id="blog-title">Exercitium</span>
    </a></h1>
    <div>Ejercicios de programación con Haskell y Python</div>

        
            <nav id="menu"><ul>
<li><a href="https://jaalonso.github.io/">José A. Alonso</a></li>
                <li><a href="../../../../archive.html">Archivo</a></li>
                <li><a href="../../../../categories/">Etiquetas</a></li>
                <li><a href="../../../../about/">Acerca de</a></li>
                <li><a href="../../../../rss.xml">RSS</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Buscaminas</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
        <a href="https://jaalonso.github.io" target="_blank" rel="noopener">José A. Alonso</a>
</span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2014-06-19T06:00:00+02:00" itemprop="datePublished" title="19-06-2014">19-06-2014</time><span class="updated"> (actualizado
                    <time class="updated dt-updated" datetime="2025-09-01T06:00:00+02:00" itemprop="dateUpdated" title="01-09-2025">01-09-2025</time>)</span>
            </a>
            </p>
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <hr>
<p>El buscaminas es un juego cuyo objetivo es despejar un campo de minas sin detonar ninguna.</p>
<p>El campo de minas se representa mediante un cuadrado con NxN casillas. Algunas casillas tienen un número, este número indica las minas que hay en todas las casillas vecinas. Cada casilla tiene como máximo 8 vecinas. Por ejemplo, el campo 4x4 de la izquierda contiene dos minas, cada una representada por el número 9, y a la  derecha se muestra el campo obtenido anotando las minas vecinas de cada casilla</p>
<div class="code"><pre class="code literal-block"><span class="mf">9</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">       </span><span class="mf">9</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span>
<span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">       </span><span class="mf">2</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span>
<span class="mf">0</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">       </span><span class="mf">1</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span>
<span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">       </span><span class="mf">1</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span>
</pre></div>

<p>de la misma forma, la anotación del siguiente a la izquierda es el de la derecha</p>
<div class="code"><pre class="code literal-block"><span class="mf">9</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">     </span><span class="mf">9</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span>
<span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">     </span><span class="mf">3</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span>
<span class="mf">0</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span><span class="w">     </span><span class="mf">1</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="mf">0</span>
</pre></div>

<p>Utilizando la librería <code>Data.Matrix</code>, los campos de minas se representan mediante matrices:</p>
<div class="code"><pre class="code literal-block"><span class="kr">type</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Matrix</span><span class="w"> </span><span class="kt">Int</span>
</pre></div>

<p>Por ejemplo, los anteriores campos de la izquierda se definen por</p>
<div class="code"><pre class="code literal-block"><span class="nf">ejCampo1</span><span class="p">,</span><span class="w"> </span><span class="n">ejCampo2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">ejCampo1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="nf">ejCampo2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>

<p>Definir la función</p>
<div class="code"><pre class="code literal-block"><span class="nf">buscaminas</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span>
</pre></div>

<p>tal que <code>buscaminas c</code> es el campo obtenido anotando las minas vecinas de cada casilla. Por ejemplo,</p>
<div class="code"><pre class="code literal-block"><span class="nf">λ</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buscaminas</span><span class="w"> </span><span class="n">ejCampo1</span>
<span class="p">(</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>

<span class="nf">λ</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buscaminas</span><span class="w"> </span><span class="n">ejCampo2</span>
<span class="p">(</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
</pre></div>

<hr>
<!-- TEASER_END --><h3>Soluciones</h3>
<div class="code"><pre class="code literal-block"><span class="kr">import</span><span class="w"> </span><span class="nn">Data.List</span><span class="w"> </span><span class="p">(</span><span class="nf">foldl'</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Data.Matrix</span><span class="w"> </span><span class="p">(</span><span class="kt">Matrix</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">),</span><span class="w"> </span><span class="nf">fromLists</span><span class="p">,</span><span class="w"> </span><span class="nf">matrix</span><span class="p">,</span><span class="w"> </span><span class="nf">mapPos</span><span class="p">,</span><span class="w"> </span><span class="nf">nrows</span><span class="p">,</span><span class="w"> </span><span class="nf">ncols</span><span class="p">,</span><span class="w"> </span><span class="nf">toLists</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Control.Monad</span><span class="w"> </span><span class="p">(</span><span class="nf">replicateM</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Test.Hspec</span><span class="w"> </span><span class="p">(</span><span class="kt">Spec</span><span class="p">,</span><span class="w"> </span><span class="nf">describe</span><span class="p">,</span><span class="w"> </span><span class="nf">hspec</span><span class="p">,</span><span class="w"> </span><span class="nf">it</span><span class="p">,</span><span class="w"> </span><span class="nf">shouldBe</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Test.QuickCheck</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">Campo</span><span class="w">   </span><span class="ow">=</span><span class="w"> </span><span class="kt">Matrix</span><span class="w"> </span><span class="kt">Int</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span><span class="kt">Int</span><span class="p">)</span>

<span class="nf">ejCampo1</span><span class="p">,</span><span class="w"> </span><span class="n">ejCampo2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">ejCampo1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="nf">ejCampo2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">                      </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1">-- 1ª solución</span>
<span class="c1">-- ===========</span>

<span class="nf">buscaminas1</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">buscaminas1</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">minas</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">c</span>

<span class="c1">-- (minas c (i,j)) es el número de minas en las casillas vecinas de la</span>
<span class="c1">-- (i,j) en el campo de mina c y es 9 si en (i,j) hay una mina. Por</span>
<span class="c1">-- ejemplo,</span>
<span class="c1">--    minas ejCampo (1,1)  ==  9</span>
<span class="c1">--    minas ejCampo (1,2)  ==  1</span>
<span class="c1">--    minas ejCampo (1,3)  ==  0</span>
<span class="c1">--    minas ejCampo (2,1)  ==  2</span>
<span class="nf">minas</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nf">minas</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">9</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">otherwise</span><span class="w">    </span><span class="ow">=</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">vecinas</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)])</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">c</span>

<span class="c1">-- (vecinas m n (i,j)) es la lista de las casillas vecinas de la (i,j) en</span>
<span class="c1">-- un campo de dimensiones mxn. Por ejemplo,</span>
<span class="c1">--    vecinas 4 (1,1)  ==  [(1,2),(2,1),(2,2)]</span>
<span class="c1">--    vecinas 4 (1,2)  ==  [(1,1),(1,3),(2,1),(2,2),(2,3)]</span>
<span class="c1">--    vecinas 4 (2,3)  ==  [(1,2),(1,3),(1,4),(2,2),(2,4),(3,2),(3,3),(3,4)]</span>
<span class="nf">vecinas</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Casilla</span><span class="p">]</span>
<span class="nf">vecinas</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="n">max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">min</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
<span class="w">                             </span><span class="n">b</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="n">max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">min</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
<span class="w">                             </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span>

<span class="c1">-- 2ª solución</span>
<span class="c1">-- ===========</span>

<span class="nf">buscaminas2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">buscaminas2</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">minas'</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">minas'</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">        </span><span class="n">minas'</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">9</span>
<span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="n">otherwise</span><span class="w">    </span><span class="ow">=</span>
<span class="w">              </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">vecinas'</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)])</span>
<span class="w">        </span><span class="n">vecinas'</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Casilla</span><span class="p">]</span>
<span class="w">        </span><span class="n">vecinas'</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="n">max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">min</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
<span class="w">                                  </span><span class="n">b</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="n">max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">min</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
<span class="w">                                  </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span>

<span class="c1">-- 3ª solución</span>
<span class="c1">-- ===========</span>

<span class="nf">buscaminas3</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">buscaminas3</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">minas2</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">c</span>

<span class="nf">minas2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Casilla</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nf">minas2</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">9</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">otherwise</span><span class="w">    </span><span class="ow">=</span><span class="w"> </span><span class="n">foldl'</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">acc</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="n">acc</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="n">acc</span><span class="p">)</span>
<span class="w">                          </span><span class="mi">0</span>
<span class="w">                          </span><span class="p">[</span><span class="n">c</span><span class="o">!</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">vecinas</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">c</span>
<span class="w">        </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">c</span>

<span class="c1">-- 4ª solución</span>
<span class="c1">-- ===========</span>

<span class="nf">buscaminas4</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span>
<span class="nf">buscaminas4</span><span class="w"> </span><span class="n">campo</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">mapPos</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">campo</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">val</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">9</span>
<span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">contarAlrededor</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<span class="w">    </span><span class="n">contarAlrededor</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">length</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nb">()</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">di</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">dj</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">..</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="n">dj</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="kr">let</span><span class="w"> </span><span class="n">ni</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="kr">let</span><span class="w"> </span><span class="n">nj</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="n">dj</span>
<span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">inRange</span><span class="w"> </span><span class="n">ni</span><span class="w"> </span><span class="n">nj</span>
<span class="w">             </span><span class="p">,</span><span class="w"> </span><span class="n">campo</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">ni</span><span class="p">,</span><span class="n">nj</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="p">]</span>
<span class="w">    </span><span class="n">inRange</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows</span><span class="w"> </span><span class="n">campo</span>
<span class="w">               </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">ncols</span><span class="w"> </span><span class="n">campo</span>

<span class="c1">-- Verificación</span>
<span class="c1">-- ============</span>

<span class="nf">verifica</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">verifica</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">hspec</span><span class="w"> </span><span class="n">spec</span>

<span class="nf">specG</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">(</span><span class="kt">Campo</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Campo</span><span class="p">)</span><span class="w">  </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">specG</span><span class="w"> </span><span class="n">buscaminas</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="s">"e1"</span><span class="w"> </span><span class="o">$</span>
<span class="w">    </span><span class="n">toLists</span><span class="w"> </span><span class="p">(</span><span class="n">buscaminas</span><span class="w"> </span><span class="n">ejCampo1</span><span class="p">)</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span>
<span class="w">    </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="s">"e2"</span><span class="w"> </span><span class="o">$</span>
<span class="w">    </span><span class="n">toLists</span><span class="w"> </span><span class="p">(</span><span class="n">buscaminas</span><span class="w"> </span><span class="n">ejCampo2</span><span class="p">)</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span>
<span class="w">    </span><span class="p">[[</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>

<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 1"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">buscaminas1</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 2"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">buscaminas2</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 3"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">buscaminas3</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 4"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">buscaminas4</span>

<span class="c1">-- La verificación es</span>
<span class="c1">--    λ&gt; verifica</span>
<span class="c1">--    4 examples, 0 failures</span>

<span class="c1">-- Equivalencia de las definiciones</span>
<span class="c1">-- ================================</span>

<span class="kr">newtype</span><span class="w"> </span><span class="kt">Campo2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">C</span><span class="w"> </span><span class="kt">Campo</span>

<span class="kr">instance</span><span class="w"> </span><span class="kt">Show</span><span class="w"> </span><span class="kt">Campo2</span><span class="w"> </span><span class="kr">where</span>
<span class="w">  </span><span class="n">show</span><span class="w"> </span><span class="p">(</span><span class="kt">C</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">p</span>

<span class="c1">-- Generador aleatorio de una casilla (0 = vacío, 9 = mina). Por</span>
<span class="c1">-- ejemplo,</span>
<span class="c1">--    λ&gt; generate genCasilla</span>
<span class="c1">--    9</span>
<span class="c1">--    λ&gt; generate genCasilla</span>
<span class="c1">--    0</span>
<span class="nf">genCasilla</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Gen</span><span class="w"> </span><span class="kt">Int</span>
<span class="nf">genCasilla</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>

<span class="c1">-- Generador de campos. Por ejemplo,</span>
<span class="c1">--    λ&gt; generate (genCampo 5)</span>
<span class="c1">--    ┌         ┐</span>
<span class="c1">--    │ 0 9 9 0 │</span>
<span class="c1">--    │ 9 0 0 9 │</span>
<span class="c1">--    │ 0 9 0 0 │</span>
<span class="c1">--    └         ┘</span>
<span class="nf">genCampo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Gen</span><span class="w"> </span><span class="kt">Campo2</span>
<span class="nf">genCampo</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="kr">let</span><span class="w"> </span><span class="n">cota</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">a</span>
<span class="w">  </span><span class="n">m</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">choose</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cota</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">choose</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">cota</span><span class="p">)</span>
<span class="w">  </span><span class="n">rows</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">replicateM</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">(</span><span class="n">replicateM</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="n">genCasilla</span><span class="p">)</span>
<span class="w">  </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="kt">C</span><span class="w"> </span><span class="p">(</span><span class="n">fromLists</span><span class="w"> </span><span class="n">rows</span><span class="p">))</span>

<span class="kr">instance</span><span class="w"> </span><span class="kt">Arbitrary</span><span class="w"> </span><span class="kt">Campo2</span><span class="w"> </span><span class="kr">where</span>
<span class="w">  </span><span class="n">arbitrary</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sized</span><span class="w"> </span><span class="n">genCampo</span>

<span class="c1">-- La propiedad es</span>
<span class="nf">prop_buscaminas</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Campo2</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nf">prop_buscaminas</span><span class="w"> </span><span class="p">(</span><span class="kt">C</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">all</span><span class="w"> </span><span class="p">(</span><span class="o">==</span><span class="w"> </span><span class="n">buscaminas1</span><span class="w"> </span><span class="n">p</span><span class="p">)</span>
<span class="w">      </span><span class="p">[</span><span class="n">buscaminas2</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">       </span><span class="n">buscaminas3</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">       </span><span class="n">buscaminas4</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>

<span class="c1">-- La comprobación es</span>
<span class="c1">--    λ&gt; quickCheck prop_buscaminas</span>
<span class="c1">--    +++ OK, passed 100 tests.</span>

<span class="c1">-- Comparación de eficiencia</span>
<span class="c1">-- =========================</span>

<span class="c1">-- La comparación es</span>
<span class="c1">--    λ&gt; C p &lt;- generate (genCampo 20000)</span>
<span class="c1">--    λ&gt; length (buscaminas1 p)</span>
<span class="c1">--    9414947</span>
<span class="c1">--    (3.41 secs, 3,164,606,704 bytes)</span>
<span class="c1">--    λ&gt; length (buscaminas2 p)</span>
<span class="c1">--    9414947</span>
<span class="c1">--    (1.21 secs, 678,499,992 bytes)</span>
<span class="c1">--    λ&gt; length (buscaminas3 p)</span>
<span class="c1">--    9414947</span>
<span class="c1">--    (0.50 secs, 678,499,952 bytes)</span>
<span class="c1">--    λ&gt; length (buscaminas4 p)</span>
<span class="c1">--    9414947</span>
<span class="c1">--    (0.86 secs, 678,499,992 bytes)</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../18-seleccion_con_fallo/" rel="prev" title="Selección hasta el primero que falla inclusive">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../20-mayor_sucesion_3n%2B1/" rel="next" title="Mayor sucesión del problema 3n+1">Siguiente publicación</a>
            </li>
        </ul></nav></aside></article></main><footer id="footer"><p>Escrito por <a href="https://jaalonso.github.io/">José A. Alonso</a> usando <a href="https://getnikola.com" rel="nofollow">Nikola</a> <br> Esta obra está bajo una 
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a></p>
            
        </footer>
</div>
        

    
    
</body>
</html>
