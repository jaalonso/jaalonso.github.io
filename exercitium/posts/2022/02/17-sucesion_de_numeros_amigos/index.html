<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sucesión de números amigos | Exercitium</title>
<link href="../../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<link href="../../../../assets/css/extras.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="es" href="../../../../rss.xml">
<link rel="canonical" href="https://jaalonso.github.io/exercitium/posts/2022/02/17-sucesion_de_numeros_amigos/">
<link rel="icon" href="../../../../favicon.png" sizes="48x48">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jaalonso.github.io/exercitium/meta-twitter.png">
<meta name="twitter:title" content="Sucesión de números amigos | Exercitium">
<meta name="author" content="José A. Alonso">
<link rel="prev" href="../16-numeros_amigos/" title="Números amigos" type="text/html">
<link rel="next" href="../../08/07-introduccion_a_la-programacion_con_haskell_y_python/" title="Curso de introducción a la programación con Haskell y Python" type="text/html">
<meta property="og:site_name" content="Exercitium">
<meta property="og:title" content="Sucesión de números amigos">
<meta property="og:url" content="https://jaalonso.github.io/exercitium/posts/2022/02/17-sucesion_de_numeros_amigos/">
<meta property="og:description" content="Dos números amigos son dos números enteros  positivos distintos tales que la suma de los divisores propios de cada uno es igual al otro. Los divisores propios de un número incluyen la unidad pero no a">
<meta property="og:image" content="https://jaalonso.github.io/exercitium/favicon.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-02-17T06:00:00+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../../../" title="Exercitium" rel="home">

        <span id="blog-title">Exercitium</span>
    </a></h1>
    <div>Ejercicios de programación con Haskell y Python</div>

        
            <nav id="menu"><ul>
<li><a href="https://jaalonso.github.io/">José A. Alonso</a></li>
                <li><a href="../../../../archive.html">Archivo</a></li>
                <li><a href="../../../../categories/">Etiquetas</a></li>
                <li><a href="../../../../about/">Acerca de</a></li>
                <li><a href="../../../../rss.xml">RSS</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Sucesión de números amigos</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    José A. Alonso
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-02-17T06:00:00+02:00" itemprop="datePublished" title="17-02-2022">17-02-2022</time></a>
            </p>
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Dos <a href="https://tinyurl.com/2y2ktgb9">números amigos</a> son dos números enteros  positivos distintos tales que la suma de los divisores propios de cada uno es igual al otro. Los divisores propios de un número incluyen la unidad pero no al propio número. Por ejemplo, los divisores propios de 220 son 1, 2, 4, 5, 10, 11, 20, 22, 44, 55 y 110. La suma de estos números equivale a 284. A su vez, los divisores propios de 284 son 1, 2, 4, 71 y 142. Su suma equivale a 220. Por tanto, 220 y 284 son amigos.</p>
<p>Definir la lista</p>
<div class="code"><pre class="code literal-block"><span class="nf">sucesionAmigos</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
</pre></div>

<p>cuyos elementos son los pares de números amigos con la primera componente menor que la segunda. Por ejemplo,</p>
<div class="code"><pre class="code literal-block"><span class="nf">take</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">sucesionAmigos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">[(</span><span class="mi">220</span><span class="p">,</span><span class="mi">284</span><span class="p">),(</span><span class="mi">1184</span><span class="p">,</span><span class="mi">1210</span><span class="p">),(</span><span class="mi">2620</span><span class="p">,</span><span class="mi">2924</span><span class="p">),(</span><span class="mi">5020</span><span class="p">,</span><span class="mi">5564</span><span class="p">)]</span>
<span class="nf">sucesionAmigos6</span><span class="w"> </span><span class="o">!!</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="mi">185368</span><span class="p">,</span><span class="mi">203432</span><span class="p">)</span>
</pre></div>

<!-- TEASER_END -->

<h2>1. Soluciones en Haskell</h2>
<div class="code"><pre class="code literal-block"><span class="kr">import</span><span class="w"> </span><span class="nn">Data.List</span><span class="w"> </span><span class="p">(</span><span class="nf">genericLength</span><span class="p">,</span><span class="w"> </span><span class="nf">group</span><span class="p">,</span><span class="w"> </span><span class="nf">inits</span><span class="p">,</span><span class="w"> </span><span class="nf">nub</span><span class="p">,</span><span class="w"> </span><span class="nf">sort</span><span class="p">,</span><span class="w"> </span><span class="nf">subsequences</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Data.Numbers.Primes</span><span class="w"> </span><span class="p">(</span><span class="nf">primeFactors</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Test.Hspec</span><span class="w"> </span><span class="p">(</span><span class="kt">Spec</span><span class="p">,</span><span class="w"> </span><span class="nf">describe</span><span class="p">,</span><span class="w"> </span><span class="nf">hspec</span><span class="p">,</span><span class="w"> </span><span class="nf">it</span><span class="p">,</span><span class="w"> </span><span class="nf">shouldBe</span><span class="p">)</span>

<span class="c1">-- 1ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos1</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos1</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios1</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios1</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="c1">-- (sumaDivisoresPropios1 x) es la suma de los divisores propios de</span>
<span class="c1">-- x. Por ejemplo,</span>
<span class="c1">--    sumaDivisoresPropios1 220  ==  284</span>
<span class="c1">--    sumaDivisoresPropios1 284  ==  220</span>
<span class="nf">sumaDivisoresPropios1</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">divisoresPropios1</span>

<span class="c1">-- (divisoresPropios1 x) es la lista de los divisores propios de x. Por</span>
<span class="c1">-- ejemplo,</span>
<span class="c1">--    divisoresPropios1 220  ==  [1,2,4,5,10,11,20,22,44,55,110]</span>
<span class="c1">--    divisoresPropios1 284  ==  [1,2,4,71,142]</span>
<span class="nf">divisoresPropios1</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">divisoresPropios1</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">`</span><span class="n">mod</span><span class="p">`</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>

<span class="c1">-- 2ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos2</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios2</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios2</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">sumaDivisoresPropios2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">divisoresPropios2</span>

<span class="nf">divisoresPropios2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">divisoresPropios2</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="p">((</span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">-- 3ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos3</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos3</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios3</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios3</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">sumaDivisoresPropios3</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios3</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">divisoresPropios3</span>

<span class="nf">divisoresPropios3</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">divisoresPropios3</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">init</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">nub</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">product</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">subsequences</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">primeFactors</span>

<span class="c1">-- 4ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos4</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos4</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios4</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios4</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">sumaDivisoresPropios4</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios4</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">divisoresPropios4</span>

<span class="nf">divisoresPropios4</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">divisoresPropios4</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">init</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">sort</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="p">(</span><span class="n">product</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">concat</span><span class="p">)</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">productoCartesiano</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">inits</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">group</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">primeFactors</span>

<span class="c1">-- (productoCartesiano xss) es el producto cartesiano de los conjuntos</span>
<span class="c1">-- xss. Por ejemplo,</span>
<span class="c1">--    λ&gt; productoCartesiano [[1,3],[2,5],[6,4]]</span>
<span class="c1">--    [[1,2,6],[1,2,4],[1,5,6],[1,5,4],[3,2,6],[3,2,4],[3,5,6],[3,5,4]]</span>
<span class="nf">productoCartesiano</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[[</span><span class="n">a</span><span class="p">]]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[[</span><span class="n">a</span><span class="p">]]</span>
<span class="nf">productoCartesiano</span><span class="w"> </span><span class="kt">[]</span><span class="w">       </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="kt">[]</span><span class="p">]</span>
<span class="nf">productoCartesiano</span><span class="w"> </span><span class="p">(</span><span class="n">xs</span><span class="kt">:</span><span class="n">xss</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[</span><span class="n">x</span><span class="kt">:</span><span class="n">ys</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">productoCartesiano</span><span class="w"> </span><span class="n">xss</span><span class="p">]</span>

<span class="c1">-- 5ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos5</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos5</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios5</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios5</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">sumaDivisoresPropios5</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios5</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">divisoresPropios5</span>

<span class="nf">divisoresPropios5</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Integer</span><span class="p">]</span>
<span class="nf">divisoresPropios5</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">init</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">sort</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="p">(</span><span class="n">product</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">concat</span><span class="p">)</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">sequence</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">inits</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">group</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">primeFactors</span>

<span class="c1">-- 6ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos6</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos6</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios6</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios6</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">sumaDivisoresPropios6</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios6</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">sum</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">init</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="p">(</span><span class="n">product</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">concat</span><span class="p">)</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">mapM</span><span class="w"> </span><span class="n">inits</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">group</span>
<span class="w">  </span><span class="o">.</span><span class="w"> </span><span class="n">primeFactors</span>

<span class="c1">-- 7ª solución                                                   --</span>
<span class="c1">-- ===========</span>

<span class="nf">sucesionAmigos7</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">sucesionAmigos7</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="p">],</span>
<span class="w">           </span><span class="kr">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">sumaDivisoresPropios7</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">sumaDivisoresPropios7</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="c1">-- Si la descomposición de x en factores primos es</span>
<span class="c1">--    x = p(1)^e(1) . p(2)^e(2) . .... . p(n)^e(n)</span>
<span class="c1">-- entonces la suma de los divisores de x es</span>
<span class="c1">--    p(1)^(e(1)+1) - 1     p(2)^(e(2)+1) - 1       p(n)^(e(2)+1) - 1</span>
<span class="c1">--   ------------------- . ------------------- ... -------------------</span>
<span class="c1">--        p(1)-1                p(2)-1                  p(n)-1</span>
<span class="c1">-- Ver la demostración en http://bit.ly/2zUXZPc</span>

<span class="nf">sumaDivisoresPropios7</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Integer</span>
<span class="nf">sumaDivisoresPropios7</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">product</span><span class="w"> </span><span class="p">[(</span><span class="n">p</span><span class="o">^</span><span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">`</span><span class="n">div</span><span class="p">`</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">factorizacion</span><span class="w"> </span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span>

<span class="c1">-- (factorizacion x) es la lista de las bases y exponentes de la</span>
<span class="c1">-- descomposición prima de x. Por ejemplo,</span>
<span class="c1">--    factorizacion 600  ==  [(2,3),(3,1),(5,2)]</span>
<span class="nf">factorizacion</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Integer</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span>
<span class="nf">factorizacion</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">primeroYlongitud</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">primeFactors</span>

<span class="c1">-- (primeroYlongitud xs) es el par formado por el primer elemento de xs</span>
<span class="c1">-- y la longitud de xs. Por ejemplo,</span>
<span class="c1">--    primeroYlongitud [3,2,5,7] == (3,4)</span>
<span class="nf">primeroYlongitud</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)</span>
<span class="nf">primeroYlongitud</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">genericLength</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>

<span class="c1">-- Verificación</span>
<span class="c1">-- ============</span>

<span class="nf">verifica</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">verifica</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">hspec</span><span class="w"> </span><span class="n">spec</span>

<span class="nf">specG</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[(</span><span class="kt">Integer</span><span class="p">,</span><span class="kt">Integer</span><span class="p">)]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">specG</span><span class="w"> </span><span class="n">sucesionAmigos</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="s">"e1"</span><span class="w"> </span><span class="o">$</span>
<span class="w">    </span><span class="n">head</span><span class="w"> </span><span class="n">sucesionAmigos</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="p">(</span><span class="mi">220</span><span class="p">,</span><span class="mi">284</span><span class="p">)</span>

<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 1"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos1</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 2"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos2</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 3"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos3</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 4"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos4</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 5"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos5</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 6"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos6</span>
<span class="w">  </span><span class="n">describe</span><span class="w"> </span><span class="s">"def. 7"</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">specG</span><span class="w"> </span><span class="n">sucesionAmigos7</span>

<span class="c1">-- La verificación es</span>
<span class="c1">--    λ&gt; verifica</span>
<span class="c1">--    7 examples, 0 failures</span>

<span class="c1">-- Comparación de eficiencia</span>
<span class="c1">-- =========================</span>

<span class="c1">-- La comparación es</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos1</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (6.00 secs, 3,413,777,560 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos2</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (2.38 secs, 2,052,151,800 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos3</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (0.14 secs, 235,238,864 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos4</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (0.20 secs, 208,315,832 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos5</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (0.09 secs, 176,149,160 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos6</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (0.07 secs, 154,686,728 bytes)</span>
<span class="c1">--    λ&gt; take 4 sucesionAmigos7</span>
<span class="c1">--    [(220,284),(1184,1210),(2620,2924),(5020,5564)]</span>
<span class="c1">--    (0.12 secs, 120,826,648 bytes)</span>
<span class="c1">--</span>
<span class="c1">--    λ&gt; sucesionAmigos3 !! 10</span>
<span class="c1">--    (67095,71145)</span>
<span class="c1">--    (3.52 secs, 6,749,059,064 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos4 !! 10</span>
<span class="c1">--    (67095,71145)</span>
<span class="c1">--    (3.11 secs, 4,951,018,904 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos5 !! 10</span>
<span class="c1">--    (67095,71145)</span>
<span class="c1">--    (1.69 secs, 4,294,457,320 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos6 !! 10</span>
<span class="c1">--    (67095,71145)</span>
<span class="c1">--    (1.43 secs, 3,889,045,760 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos7 !! 10</span>
<span class="c1">--    (67095,71145)</span>
<span class="c1">--    (1.63 secs, 3,191,073,224 bytes)</span>
<span class="c1">--</span>
<span class="c1">--    λ&gt; sucesionAmigos5 !! 12</span>
<span class="c1">--    (79750,88730)</span>
<span class="c1">--    (2.13 secs, 5,312,053,312 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos6 !! 12</span>
<span class="c1">--    (79750,88730)</span>
<span class="c1">--    (1.78 secs, 4,820,560,920 bytes)</span>
<span class="c1">--    λ&gt; sucesionAmigos7 !! 12</span>
<span class="c1">--    (79750,88730)</span>
<span class="c1">--    (2.11 secs, 3,971,113,184 bytes)</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../16-numeros_amigos/" rel="prev" title="Números amigos">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../../08/07-introduccion_a_la-programacion_con_haskell_y_python/" rel="next" title="Curso de introducción a la programación con Haskell y Python">Siguiente publicación</a>
            </li>
        </ul></nav></aside></article></main><footer id="footer"><p>Escrito por <a href="https://jaalonso.github.io/">José A. Alonso</a> usando <a href="https://getnikola.com" rel="nofollow">Nikola</a> <br> Esta obra está bajo una 
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a></p>
            
        </footer>
</div>
        

    
    
</body>
</html>
