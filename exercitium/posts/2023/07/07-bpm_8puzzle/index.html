<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>El problema del 8 puzzle | Exercitium</title>
<link href="../../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<link href="../../../../assets/css/extras.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="es" href="../../../../rss.xml">
<link rel="canonical" href="https://jaalonso.github.io/exercitium/posts/2023/07/07-bpm_8puzzle/">
<link rel="icon" href="../../../../favicon.png" sizes="48x48">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jaalonso.github.io/exercitium/meta-twitter.png">
<meta name="twitter:title" content="El problema del 8 puzzle | Exercitium">
<meta name="author" content="José A. Alonso">
<link rel="prev" href="../06-busquedaprimeroelmejor/" title="Búsqueda por primero el mejor" type="text/html">
<link rel="next" href="../../08/04-busquedaenescalada/" title="Búsqueda en escalada" type="text/html">
<meta property="og:site_name" content="Exercitium">
<meta property="og:title" content="El problema del 8 puzzle">
<meta property="og:url" content="https://jaalonso.github.io/exercitium/posts/2023/07/07-bpm_8puzzle/">
<meta property="og:description" content="Para el 8-puzzle se usa un cajón cuadrado en el que hay situados  bloques cuadrados. El cuadrado restante está sin rellenar. Cada bloque tiene un número. Un bloque adyacente al hueco puede deslizarse ">
<meta property="og:image" content="https://jaalonso.github.io/exercitium/favicon.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-07-07T06:00:00+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../../../" title="Exercitium" rel="home">

        <span id="blog-title">Exercitium</span>
    </a></h1>
    <div>Ejercicios de programación con Haskell y Python</div>

        
            <nav id="menu"><ul>
<li><a href="https://jaalonso.github.io/">José A. Alonso</a></li>
                <li><a href="../../../../archive.html">Archivo</a></li>
                <li><a href="../../../../categories/">Etiquetas</a></li>
                <li><a href="../../../../about/">Acerca de</a></li>
                <li><a href="../../../../rss.xml">RSS</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">El problema del 8 puzzle</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    José A. Alonso
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-07-07T06:00:00+02:00" itemprop="datePublished" title="07-07-2023">07-07-2023</time></a>
            </p>
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Para el 8-puzzle se usa un cajón cuadrado en el que hay situados  bloques cuadrados. El cuadrado restante está sin rellenar. Cada bloque tiene un número. Un bloque adyacente al hueco puede deslizarse hacia él. El juego consiste en transformar la posición inicial en la posición final mediante el deslizamiento de los bloques. En particular, consideramos el estado inicial y final siguientes:</p>
<div class="code"><pre class="code literal-block"><span class="c">   </span><span class="nb">+---+---+---+</span><span class="c">                   </span><span class="nb">+---+---+---+</span>
<span class="c">   |   | 1 | 3 |                   | 1 | 2 | 3 |</span>
<span class="c">   </span><span class="nb">+---+---+---+</span><span class="c">                   </span><span class="nb">+---+---+---+</span>
<span class="c">   | 8 | 2 | 4 |                   | 8 |   | 4 |</span>
<span class="c">   </span><span class="nb">+---+---+---+</span><span class="c">                   </span><span class="nb">+---+---+---+</span>
<span class="c">   | 7 | 5 | 5 |                   | 7 | 6 | 5 |</span>
<span class="c">   </span><span class="nb">+---+---+---+</span><span class="c">                   </span><span class="nb">+---+---+---+</span>
<span class="c">   Estado inicial                  Estado final</span>
</pre></div>

<p>Para solucionar el problema se definen los siguientes tipos:</p>
<ul>
<li>
<code>Tablero</code> es una matriz de número enteros (que representan las piezas en
  cada posición y el 0 representa el hueco):</li>
</ul>
<div class="code"><pre class="code literal-block"><span class="w">     </span><span class="k">type</span><span class="w"> </span><span class="nx">Tablero</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nx">Matrix</span><span class="w"> </span><span class="nx">Int</span>
</pre></div>

<ul>
<li>
<code>Estado</code> es una listas de tableros [t_n,...,t_1] tal que t_i es un
  sucesor de t_(i-1).</li>
</ul>
<div class="code"><pre class="code literal-block"><span class="w">     </span><span class="n">newtype</span><span class="w"> </span><span class="n">Estado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Est</span><span class="w"> </span><span class="o">[</span><span class="n">Tablero</span><span class="o">]</span>
<span class="w">       </span><span class="n">deriving</span><span class="w"> </span><span class="n">Show</span>
</pre></div>

<p>Usando el procedimiento de <a href="../06-busquedaprimeroelmejor">búsqueda por primero el mejor</a>, definir la función</p>
<div class="code"><pre class="code literal-block"><span class="w">   </span><span class="n">solucion_8puzzle</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">Tablero</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Tablero</span><span class="o">]</span>
</pre></div>

<p>tal que <code>(solucion_8puzzle t)</code> es la solución del problema del problema del 8 puzzle a partir del tablero <code>t</code>. Por ejemplo,</p>
<div class="code"><pre class="code literal-block">   λ&gt; solucion_8puzzle (fromLists [[0,1,3],[8,2,4],[7,6,5]])
   [┌       ┐  ┌       ┐  ┌       ┐
    │ 0 1 3 │  │ 1 0 3 │  │ 1 2 3 │
    │ 8 2 4 │  │ 8 2 4 │  │ 8 0 4 │
    │ 7 6 5 │  │ 7 6 5 │  │ 7 6 5 │
    └       ┘, └       ┘, └       ┘]
   λ&gt; length (solucion_8puzzle (fromLists [[2,6,3],[5,0,4],[1,7,8]]))
   21
</pre></div>

<h2>Soluciones</h2>
<p>A continuación se muestran las <a href="#haskell">soluciones en Haskell</a> y las <a href="#python">soluciones en Python</a>.</p>
<p><a name="haskell"></a></p>
<h3>Soluciones en Haskell</h3>
<div class="code"><pre class="code literal-block"><span class="kr">module</span><span class="w"> </span><span class="nn">BPM_8Puzzle</span><span class="w"> </span><span class="kr">where</span>

<span class="kr">import</span><span class="w"> </span><span class="nn">BusquedaPrimeroElMejor</span><span class="w"> </span><span class="p">(</span><span class="nf">buscaPM</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Data.Matrix</span><span class="w"> </span><span class="p">(</span><span class="kt">Matrix</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">),</span><span class="w"> </span><span class="nf">fromLists</span><span class="p">,</span><span class="w"> </span><span class="nf">setElem</span><span class="p">,</span><span class="w"> </span><span class="nf">toLists</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Test.Hspec</span><span class="w"> </span><span class="p">(</span><span class="kt">Spec</span><span class="p">,</span><span class="w"> </span><span class="nf">hspec</span><span class="p">,</span><span class="w"> </span><span class="nf">it</span><span class="p">,</span><span class="w"> </span><span class="nf">shouldBe</span><span class="p">)</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">Tablero</span><span class="w">  </span><span class="ow">=</span><span class="w"> </span><span class="kt">Matrix</span><span class="w"> </span><span class="kt">Int</span>

<span class="kr">newtype</span><span class="w"> </span><span class="kt">Estado</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Est</span><span class="w"> </span><span class="p">[</span><span class="kt">Tablero</span><span class="p">]</span>
<span class="w">  </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Eq</span><span class="p">,</span><span class="w"> </span><span class="kt">Show</span><span class="p">)</span>

<span class="nf">solucion_8puzzle</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Tablero</span><span class="p">]</span>
<span class="nf">solucion_8puzzle</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">ts</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="p">(</span><span class="kt">Est</span><span class="w"> </span><span class="n">ts</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="p">(</span><span class="n">buscaPM</span><span class="w"> </span><span class="n">sucesores</span>
<span class="w">                                 </span><span class="n">esFinal</span>
<span class="w">                                 </span><span class="p">(</span><span class="n">inicial</span><span class="w"> </span><span class="n">t</span><span class="p">))</span>

<span class="c1">-- Estado inicial</span>
<span class="c1">-- ==============</span>

<span class="c1">-- (inicial t) es el estado inicial del problema del 8 puzzle a partir del</span>
<span class="c1">-- tablero t.</span>
<span class="nf">inicial</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Estado</span>
<span class="nf">inicial</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Est</span><span class="w"> </span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

<span class="c1">-- Estado final</span>
<span class="c1">-- ============</span>

<span class="c1">-- (esFinal e) se verifica si e es un estado final.</span>
<span class="nf">esFinal</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Estado</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nf">esFinal</span><span class="w"> </span><span class="p">(</span><span class="kt">Est</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="kt">:</span><span class="kr">_</span><span class="p">))</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">tableroFinal</span>

<span class="c1">-- tableroFinal es el estado tablero final del 8 puzzle.</span>
<span class="nf">tableroFinal</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span>
<span class="nf">tableroFinal</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="w">                          </span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>

<span class="c1">-- Sucesores</span>
<span class="c1">-- =========</span>

<span class="c1">-- (sucesores e) es la lista de sucesores del estado e. Por ejemplo,</span>
<span class="c1">--    λ&gt; sucesores (Est [fromLists [[2,1,3],[8,0,4],[7,6,5]]])</span>
<span class="c1">--    [Est [┌       ┐  ┌       ┐</span>
<span class="c1">--          │ 2 0 3 │  │ 2 1 3 │</span>
<span class="c1">--          │ 8 1 4 │  │ 8 0 4 │</span>
<span class="c1">--          │ 7 6 5 │  │ 7 6 5 │</span>
<span class="c1">--          └       ┘, └       ┘],</span>
<span class="c1">--     Est [┌       ┐  ┌       ┐</span>
<span class="c1">--          │ 2 1 3 │  │ 2 1 3 │</span>
<span class="c1">--          │ 8 6 4 │  │ 8 0 4 │</span>
<span class="c1">--          │ 7 0 5 │  │ 7 6 5 │</span>
<span class="c1">--          └       ┘, └       ┘],</span>
<span class="c1">--     Est [┌       ┐  ┌       ┐</span>
<span class="c1">--          │ 2 1 3 │  │ 2 1 3 │</span>
<span class="c1">--          │ 0 8 4 │  │ 8 0 4 │</span>
<span class="c1">--          │ 7 6 5 │  │ 7 6 5 │</span>
<span class="c1">--          └       ┘, └       ┘],</span>
<span class="c1">--     Est [┌       ┐  ┌       ┐</span>
<span class="c1">--          │ 2 1 3 │  │ 2 1 3 │</span>
<span class="c1">--          │ 8 4 0 │  │ 8 0 4 │</span>
<span class="c1">--          │ 7 6 5 │  │ 7 6 5 │</span>
<span class="c1">--          └       ┘, └       ┘]]</span>
<span class="nf">sucesores</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Estado</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Estado</span><span class="p">]</span>
<span class="nf">sucesores</span><span class="w"> </span><span class="p">(</span><span class="kt">Est</span><span class="w"> </span><span class="n">e</span><span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="kt">:</span><span class="kr">_</span><span class="p">))</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[</span><span class="kt">Est</span><span class="w"> </span><span class="p">(</span><span class="n">t'</span><span class="kt">:</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">t'</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">tablerosSucesores</span><span class="w"> </span><span class="n">t</span><span class="p">,</span>
<span class="w">                </span><span class="n">t'</span><span class="w"> </span><span class="p">`</span><span class="n">notElem</span><span class="p">`</span><span class="w"> </span><span class="n">e</span><span class="p">]</span>

<span class="c1">-- (tablerosSucesores t) es la lista de los tableros sucesores del</span>
<span class="c1">-- tablero t. Por ejemplo,</span>
<span class="c1">--    λ&gt; tablerosSucesores (fromLists [[2,1,3],[8,0,4],[7,6,5]])</span>
<span class="c1">--    [┌       ┐  ┌       ┐  ┌       ┐  ┌       ┐</span>
<span class="c1">--     │ 2 0 3 │  │ 2 1 3 │  │ 2 1 3 │  │ 2 1 3 │</span>
<span class="c1">--     │ 8 1 4 │  │ 8 6 4 │  │ 0 8 4 │  │ 8 4 0 │</span>
<span class="c1">--     │ 7 6 5 │  │ 7 0 5 │  │ 7 6 5 │  │ 7 6 5 │</span>
<span class="c1">--     └       ┘, └       ┘, └       ┘, └       ┘]</span>
<span class="nf">tablerosSucesores</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Tablero</span><span class="p">]</span>
<span class="nf">tablerosSucesores</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[</span><span class="n">intercambia</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">posicionesVecinas</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">posicionHueco</span><span class="w"> </span><span class="n">t</span>

<span class="c1">-- Una posición es un par de enteros.</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span><span class="kt">Int</span><span class="p">)</span>

<span class="c1">-- (posicionesVecinas p) son las posiciones de la matriz cuadrada de</span>
<span class="c1">-- dimensión 3 que se encuentran encima, abajo, a la izquierda y a la</span>
<span class="c1">-- derecha de los posición p. Por ejemplo,</span>
<span class="c1">--    λ&gt; posicionesVecinas (2,2)</span>
<span class="c1">--    [(1,2),(3,2),(2,1),(2,3)]</span>
<span class="c1">--    λ&gt; posicionesVecinas (1,2)</span>
<span class="c1">--    [(2,2),(1,1),(1,3)]</span>
<span class="c1">--    λ&gt; posicionesVecinas (1,1)</span>
<span class="c1">--    [(2,1),(1,2)]</span>
<span class="nf">posicionesVecinas</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Posicion</span><span class="p">]</span>
<span class="nf">posicionesVecinas</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="p">[(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">++</span>
<span class="w">  </span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">++</span>
<span class="w">  </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">++</span>
<span class="w">  </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span>

<span class="c1">-- (posicionHueco t) es la posición del hueco en el tablero t. Por</span>
<span class="c1">-- ejemplo,</span>
<span class="c1">--    λ&gt; posicionHueco (fromLists [[2,1,3],[8,0,4],[7,6,5]])</span>
<span class="c1">--    (2,2)</span>
<span class="nf">posicionHueco</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Posicion</span>
<span class="nf">posicionHueco</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">posicionElemento</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="mi">0</span>

<span class="c1">-- (posicionElemento t a) es la posición de elemento a en el tablero</span>
<span class="c1">-- t. Por ejemplo,</span>
<span class="c1">--    λ&gt; posicionElemento (fromLists [[2,1,3],[8,0,4],[7,6,5]]) 4</span>
<span class="c1">--    (2,3)</span>
<span class="nf">posicionElemento</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Posicion</span>
<span class="nf">posicionElemento</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">head</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                </span><span class="n">j</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                </span><span class="n">t</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a</span><span class="p">]</span>

<span class="c1">-- (intercambia t p1 p2) es el tablero obtenido intercambiando en t los</span>
<span class="c1">-- elementos que se encuentran en las posiciones p1 y p2. Por ejemplo,</span>
<span class="c1">--    λ&gt; intercambia (fromLists [[2,1,3],[8,0,4],[7,6,5]]) (1,2) (2,2)</span>
<span class="c1">--    ┌       ┐</span>
<span class="c1">--    │ 2 0 3 │</span>
<span class="c1">--    │ 8 1 4 │</span>
<span class="c1">--    │ 7 6 5 │</span>
<span class="c1">--    └       ┘</span>
<span class="nf">intercambia</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Tablero</span>
<span class="nf">intercambia</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">setElem</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="p">(</span><span class="n">setElem</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="n">t</span><span class="p">)</span>
<span class="w">  </span><span class="kr">where</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">p1</span>
<span class="w">        </span><span class="n">a2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">p2</span>

<span class="c1">-- Heurística</span>
<span class="c1">-- ==========</span>

<span class="c1">-- (heuristica t) es la suma de la distancia Manhatan desde la posición de</span>
<span class="c1">-- cada objeto del tablero a su posición en el tablero final. Por</span>
<span class="c1">-- ejemplo,</span>
<span class="c1">--    λ&gt; heuristica (fromLists [[0,1,3],[8,2,4],[7,6,5]])</span>
<span class="c1">--    4</span>
<span class="nf">heuristica</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Tablero</span><span class="w">  </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nf">heuristica</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="n">sum</span><span class="w"> </span><span class="p">[</span><span class="n">distancia</span><span class="w"> </span><span class="p">(</span><span class="n">posicionElemento</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="n">posicionElemento</span><span class="w"> </span><span class="n">tableroFinal</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="mi">8</span><span class="p">]]</span>

<span class="c1">-- (distancia p1 p2) es la distancia Manhatan entre las posiciones p1 y</span>
<span class="c1">-- p2. Por ejemplo,</span>
<span class="c1">--    distancia (2,7) (4,1)  ==  8</span>
<span class="nf">distancia</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Posicion</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nf">distancia</span><span class="w"> </span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">abs</span><span class="w"> </span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">abs</span><span class="w"> </span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span>

<span class="c1">-- Comparación de estados</span>
<span class="c1">-- ======================</span>

<span class="c1">-- Un estado es menor o igual que otro si tiene la heurística de su</span>
<span class="c1">-- primer tablero es menor o que la del segundo o so iguales y el</span>
<span class="c1">-- primero es más corto.</span>
<span class="kr">instance</span><span class="w"> </span><span class="kt">Ord</span><span class="w"> </span><span class="kt">Estado</span><span class="w"> </span><span class="kr">where</span>
<span class="w">  </span><span class="kt">Est</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="kt">:</span><span class="n">ts1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="kt">Est</span><span class="w"> </span><span class="p">(</span><span class="n">t2</span><span class="kt">:</span><span class="n">ts2</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="n">heuristica</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">heuristica</span><span class="w"> </span><span class="n">t2</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">                                 </span><span class="p">((</span><span class="n">heuristica</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">heuristica</span><span class="w"> </span><span class="n">t2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                                  </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="n">ts1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">ts2</span><span class="p">))</span>

<span class="c1">-- Verificación</span>
<span class="c1">-- ============</span>

<span class="nf">verifica</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">verifica</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">hspec</span><span class="w"> </span><span class="n">spec</span>

<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="s">"e1"</span><span class="w"> </span><span class="o">$</span>
<span class="w">    </span><span class="n">map</span><span class="w"> </span><span class="n">toLists</span><span class="w"> </span><span class="p">(</span><span class="n">solucion_8puzzle</span><span class="w"> </span><span class="p">(</span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]]))</span>
<span class="w">   </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span>
<span class="w">               </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span>
<span class="w">               </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="w">                </span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]]]</span>
<span class="w">  </span><span class="n">it</span><span class="w"> </span><span class="s">"e2"</span><span class="w"> </span><span class="o">$</span>
<span class="w">    </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">solucion_8puzzle</span><span class="w"> </span><span class="p">(</span><span class="n">fromLists</span><span class="w"> </span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]]))</span>
<span class="w">    </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="mi">21</span>

<span class="c1">-- La verificación es</span>
<span class="c1">--    λ&gt; verifica</span>
<span class="c1">--</span>
<span class="c1">--    e1</span>
<span class="c1">--    e2</span>
<span class="c1">--</span>
<span class="c1">--    Finished in 0.1361 seconds</span>
<span class="c1">--    2 examples, 0 failures</span>
</pre></div>

<p><a name="python"></a></p>
<h3>Soluciones en Python</h3>
<div class="code"><pre class="code literal-block"><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">src.BusquedaPrimeroElMejor</span> <span class="kn">import</span> <span class="n">buscaPM</span>

<span class="n">Tablero</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>

<span class="c1"># Tablero final</span>
<span class="c1"># =============</span>

<span class="c1"># tableroFinal es el tablero final del 8 puzzle.</span>
<span class="n">tableroFinal</span><span class="p">:</span> <span class="n">Tablero</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>

<span class="c1"># Posiciones</span>
<span class="c1"># ==========</span>

<span class="c1"># Una posición es un par de enteros.</span>
<span class="n">Posicion</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">]</span>

<span class="c1"># Heurística</span>
<span class="c1"># ==========</span>

<span class="c1"># distancia(p1, p2) es la distancia Manhatan entre las posiciones p1 y</span>
<span class="c1"># p2. Por ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; distancia((2,7), (4,1))</span>
<span class="c1">#    8</span>
<span class="k">def</span> <span class="nf">distancia</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Posicion</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Posicion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span> <span class="o">=</span> <span class="n">p1</span>
    <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="n">p2</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span>

<span class="c1"># posicionElemento(t, a) es la posición de elemento a en el tablero</span>
<span class="c1"># t. Por ejemplo,</span>
<span class="c1">#    λ&gt; posicionElemento([[2,1,3],[8,0,4],[7,6,5]], 4)</span>
<span class="c1">#    (1, 2)</span>
<span class="k">def</span> <span class="nf">posicionElemento</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Posicion</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># posicionHueco(t) es la posición del hueco en el tablero t. Por</span>
<span class="c1"># ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; posicionHueco([[2,1,3],[8,0,4],[7,6,5]])</span>
<span class="c1">#    (1, 1)</span>
<span class="k">def</span> <span class="nf">posicionHueco</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Posicion</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">posicionElemento</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># heuristica(t) es la suma de la distancia Manhatan desde la posición de</span>
<span class="c1"># cada objeto del tablero a su posición en el tablero final. Por</span>
<span class="c1"># ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; heuristica([[0,1,3],[8,2,4],[7,6,5]])</span>
<span class="c1">#    4</span>
<span class="k">def</span> <span class="nf">heuristica</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="n">distancia</span><span class="p">(</span><span class="n">posicionElemento</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                          <span class="n">posicionElemento</span><span class="p">(</span><span class="n">tableroFinal</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)))</span>

<span class="c1"># Estados</span>
<span class="c1"># =======</span>

<span class="c1"># Un estado es una tupla (h, n, ts), donde ts es una listas de tableros</span>
<span class="c1"># [t_n,...,t_1] tal que t_i es un sucesor de t_(i-1) y h es la</span>
<span class="c1"># heurística de t_n.</span>
<span class="n">Estado</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tablero</span><span class="p">]]</span>

<span class="c1"># Estado inicial</span>
<span class="c1"># ==============</span>

<span class="c1"># inicial(t) es el estado inicial del problema del 8 puzzle a partir del</span>
<span class="c1"># tablero t.</span>
<span class="k">def</span> <span class="nf">inicial</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Estado</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">heuristica</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="p">])</span>

<span class="c1"># Estado final</span>
<span class="c1"># ============</span>

<span class="c1"># esFinal(e) se verifica si e es un estado final.</span>
<span class="k">def</span> <span class="nf">esFinal</span><span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="n">Estado</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tableroFinal</span>

<span class="c1"># Sucesores</span>
<span class="c1"># =========</span>

<span class="c1"># posicionesVecinas(p) son las posiciones de la matriz cuadrada de</span>
<span class="c1"># dimensión 3 que se encuentran encima, abajo, a la izquierda y a la</span>
<span class="c1"># derecha de los posición p. Por ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; posicionesVecinas((1,1))</span>
<span class="c1">#    [(0, 1), (2, 1), (1, 0), (1, 2)]</span>
<span class="c1">#    &gt;&gt;&gt; posicionesVecinas((0,1))</span>
<span class="c1">#    [(1, 1), (0, 0), (0, 2)]</span>
<span class="c1">#    &gt;&gt;&gt; posicionesVecinas((0,0))</span>
<span class="c1">#    [(1, 0), (0, 1)]</span>
<span class="k">def</span> <span class="nf">posicionesVecinas</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Posicion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Posicion</span><span class="p">]:</span>
    <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">vecinas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vecinas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">vecinas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vecinas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">vecinas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">vecinas</span>

<span class="c1"># intercambia(t,p1, p2) es el tablero obtenido intercambiando en t los</span>
<span class="c1"># elementos que se encuentran en las posiciones p1 y p2. Por ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; intercambia([[2,1,3],[8,0,4],[7,6,5]], (0,1), (1,1))</span>
<span class="c1">#    [[2, 0, 3], [8, 1, 4], [7, 6, 5]]</span>
<span class="k">def</span> <span class="nf">intercambia</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">,</span> <span class="n">p1</span><span class="p">:</span> <span class="n">Posicion</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Posicion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tablero</span><span class="p">:</span>
    <span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">j1</span><span class="p">)</span> <span class="o">=</span> <span class="n">p1</span>
    <span class="p">(</span><span class="n">i2</span><span class="p">,</span> <span class="n">j2</span><span class="p">)</span> <span class="o">=</span> <span class="n">p2</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">j1</span><span class="p">]</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">t1</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="n">j2</span><span class="p">]</span>
    <span class="n">t1</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">j1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a2</span>
    <span class="n">t1</span><span class="p">[</span><span class="n">i2</span><span class="p">][</span><span class="n">j2</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span>
    <span class="k">return</span> <span class="n">t1</span>

<span class="c1"># tablerosSucesores(t) es la lista de los tablrtos sucesores del</span>
<span class="c1"># tablero t. Por ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; tablerosSucesores([[2,1,3],[8,0,4],[7,6,5]])</span>
<span class="c1">#    [[[2, 0, 3], [8, 1, 4], [7, 6, 5]],</span>
<span class="c1">#     [[2, 1, 3], [8, 6, 4], [7, 0, 5]],</span>
<span class="c1">#     [[2, 1, 3], [0, 8, 4], [7, 6, 5]],</span>
<span class="c1">#     [[2, 1, 3], [8, 4, 0], [7, 6, 5]]]</span>
<span class="k">def</span> <span class="nf">tablerosSucesores</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tablero</span><span class="p">]:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">posicionHueco</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">intercambia</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">posicionesVecinas</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>

<span class="c1"># (sucesores e) es la lista de sucesores del estado e. Por ejemplo,</span>
<span class="c1">#    &gt;&gt;&gt; t1 = [[0,1,3],[8,2,4],[7,6,5]]</span>
<span class="c1">#    &gt;&gt;&gt; es = sucesores((heuristica(t1), 1, [t1]))</span>
<span class="c1">#    &gt;&gt;&gt; es</span>
<span class="c1">#    [(4, 2, [[[8, 1, 3],</span>
<span class="c1">#              [0, 2, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[0, 1, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]]]),</span>
<span class="c1">#     (2, 2, [[[1, 0, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[0, 1, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]]])]</span>
<span class="c1">#    &gt;&gt;&gt; sucesores(es[1])</span>
<span class="c1">#    [(0, 3, [[[1, 2, 3],</span>
<span class="c1">#              [8, 0, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[1, 0, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[0, 1, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]]]),</span>
<span class="c1">#     (4, 3, [[[1, 3, 0],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[1, 0, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]],</span>
<span class="c1">#             [[0, 1, 3],</span>
<span class="c1">#              [8, 2, 4],</span>
<span class="c1">#              [7, 6, 5]]])]</span>
<span class="k">def</span> <span class="nf">sucesores</span><span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="n">Estado</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Estado</span><span class="p">]:</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">heuristica</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">t1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ts</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t1</span> <span class="ow">in</span> <span class="n">tablerosSucesores</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">t1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">]</span>

<span class="c1"># Solución</span>
<span class="c1"># ========</span>

<span class="k">def</span> <span class="nf">solucion_8puzzle</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="n">Tablero</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Tablero</span><span class="p">]]:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">buscaPM</span><span class="p">(</span><span class="n">sucesores</span><span class="p">,</span> <span class="n">esFinal</span><span class="p">,</span> <span class="n">inicial</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ts</span>

<span class="c1"># Verificación</span>
<span class="c1"># ============</span>

<span class="k">def</span> <span class="nf">test_8puzzle</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">solucion_8puzzle</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span> <span class="o">==</span> \
        <span class="p">[[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
         <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
         <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
         <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]]</span>

<span class="c1"># La verificación es</span>
<span class="c1">#    src&gt; poetry run pytest -q BPM_8Puzzle.py</span>
<span class="c1">#    1 passed in 0.10s</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../06-busquedaprimeroelmejor/" rel="prev" title="Búsqueda por primero el mejor">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../../08/04-busquedaenescalada/" rel="next" title="Búsqueda en escalada">Siguiente publicación</a>
            </li>
        </ul></nav></aside></article></main><footer id="footer"><p>Escrito por <a href="https://jaalonso.github.io/">José A. Alonso</a> usando <a href="https://getnikola.com" rel="nofollow">Nikola</a> <br> Esta obra está bajo una 
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a></p>
            
        </footer>
</div>
        

    
    
</body>
</html>
