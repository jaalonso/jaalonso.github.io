<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Equivalence of inverse definitions | Calculemus</title>
<link href="../../../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather&amp;family=Open+Sans&amp;family=Source+Code+Pro:wght@400;600&amp;display=swap" rel="stylesheet">
<link href="../../../../assets/css/extras.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../../rss.xml">
<link rel="canonical" href="https://jaalonso.github.io/calculemus/posts/2024/08/19-equivalence_of_inverse_definitions/">
<link rel="icon" href="../../../../favicon.png" sizes="48x48">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jaalonso.github.io/calculemus/meta-twitter.png">
<meta name="twitter:title" content="Equivalence of inverse definitions | Calculemus">
<meta name="author" content="José A. Alonso">
<link rel="prev" href="../14-proofs_of_take_n_xs_%2B%2B_drop_n_xs_eq_xs/" title="Proofs of take n xs ++ drop n xs = xs" type="text/html">
<meta property="og:site_name" content="Calculemus">
<meta property="og:title" content="Equivalence of inverse definitions">
<meta property="og:url" content="https://jaalonso.github.io/calculemus/posts/2024/08/19-equivalence_of_inverse_definitions/">
<meta property="og:description" content="In Lean4, the function
reverse : List α → List α


such that (reverse xs) is the list obtained by reversing the order of  elements in xs, such that the first element becomes the last, the second eleme">
<meta property="og:image" content="https://jaalonso.github.io/calculemus/favicon.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-08-19T06:00:00+02:00">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
            <header id="header"><h1 id="brand"><a href="../../../../" title="Calculemus" rel="home">

        <span id="blog-title">Calculemus</span>
    </a></h1>
    <div>Proof exercises in Lean4 and Isabelle/HOL</div>

        
            <nav id="menu"><ul>
<li><a href="https://jaalonso.github.io/">José A. Alonso</a></li>
                <li><a href="../../../../archive.html">Archive</a></li>
                <li><a href="../../../../categories/">Tags</a></li>
                <li><a href="../../../../about/">About</a></li>
                <li><a href="../../../../rss.xml">RSS</a></li>

    
    
    
    </ul></nav></header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Equivalence of inverse definitions</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    José A. Alonso
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2024-08-19T06:00:00+02:00" itemprop="datePublished" title="19-08-2024">19-08-2024</time></a>
            </p>
        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>In Lean4, the function</p>
<div class="code"><pre class="code literal-block"><span class="n">reverse</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="err">α</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="err">α</span>
</pre></div>

<p>such that (reverse xs) is the list obtained by reversing the order of  elements in xs, such that the first element becomes the last, the second element becomes the second to last, and so on, resulting in a new list with the same elements but in the opposite sequence. For example,</p>
<div class="code"><pre class="code literal-block">reverse  [3,2,5,1] = [1,5,2,3]
</pre></div>

<p>Its definition is</p>
<div class="code"><pre class="code literal-block"><span class="nv">def</span><span class="w"> </span><span class="nv">reverseAux</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nv">List</span><span class="w"> </span>α<span class="w"> </span>→<span class="w"> </span><span class="nv">List</span><span class="w"> </span>α<span class="w"> </span>→<span class="w"> </span><span class="nv">List</span><span class="w"> </span>α
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[],</span><span class="w">    </span><span class="nv">ys</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">ys</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nv">x::xs</span><span class="p">,</span><span class="w"> </span><span class="nv">ys</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">reverseAux</span><span class="w"> </span><span class="nf">xs</span><span class="w"> </span><span class="p">(</span><span class="nv">x::ys</span><span class="p">)</span>

<span class="nv">def</span><span class="w"> </span><span class="nf">reverse</span><span class="w"> </span><span class="p">(</span><span class="nv">xs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nv">List</span><span class="w"> </span>α<span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nv">List</span><span class="w"> </span>α<span class="w"> </span><span class="o">:=</span>
<span class="w">  </span><span class="nv">reverseAux</span><span class="w"> </span><span class="nv">xs</span><span class="w"> </span><span class="p">[]</span>
</pre></div>

<p>The following lemmas characterize its behavior:</p>
<div class="code"><pre class="code literal-block"><span class="n">reverseAux_nil</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">reverseAux</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ys</span>
<span class="n">reverseAux_cons</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">reverseAux</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">xs</span><span class="o">)</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverseAux</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">ys</span><span class="o">)</span>
</pre></div>

<p>An alternative definition is</p>
<div class="code"><pre class="code literal-block"><span class="n">def</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">α</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">α</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="err">[]</span><span class="w">        </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">[]</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="o">[</span><span class="n">x</span><span class="o">]</span>
</pre></div>

<p>Prove that the two definitions are equivalent; that is,</p>
<div class="code"><pre class="code literal-block">reverse xs = reverse2 xs
</pre></div>

<p>To do this, complete the following Lean4 theory:</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="n">Mathlib.Data.List.Basic</span>
<span class="kn">open</span> <span class="n">List</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span>
<span class="kd">variable</span> <span class="o">(</span><span class="n">xs</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">reverse</span> <span class="n">xs</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="gr">sorry</span>
</pre></div>

<!-- TEASER_END -->

<h2>1. Natural language proof</h2>
<p>It follows from the following auxiliary lemma:</p>
<div class="code"><pre class="code literal-block">(∀ xs, ys)[reverseAux xs ys = (reverse2 xs) ++ ys]
</pre></div>

<p>Indeed,</p>
<div class="code"><pre class="code literal-block">reverse xs = reverseAux xs []
           = reverse2 xs ++ []    [por el lema auxiliar]
           = reverse2 xs
</pre></div>

<p>The auxiliary lemma is proven by induction on xs.</p>
<p>Base case: Suppose xs = []. Then,</p>
<div class="code"><pre class="code literal-block">reverseAux xs ys = reverseAux [] ys
                 = ys
                 = [] ++ ys
                 = reverse2 [] ++ ys
                 = reverse2 xs ++ ys
</pre></div>

<p>Induction step: Suppose xs = a::as and the induction hypothesis (IH):</p>
<div class="code"><pre class="code literal-block">(∀ ys)[reverseAux as ys = reverse2 as ++ ys]
</pre></div>

<p>Then,</p>
<div class="code"><pre class="code literal-block"><span class="n">reverseAux</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverseAux</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">as</span><span class="p">)</span><span class="w"> </span><span class="n">ys</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">reverseAux</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span><span class="w">   </span><span class="p">[</span><span class="n">por</span><span class="w"> </span><span class="n">IH</span><span class="p">]</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p">([</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">ys</span><span class="p">)</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">reverse2</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">])</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">ys</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">as</span><span class="p">)</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">ys</span>
<span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">reverse2</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">ys</span>
</pre></div>

<h2>2. Proofs with  Lean4</h2>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="n">Mathlib.Data.List.Basic</span>
<span class="kn">open</span> <span class="n">List</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span>
<span class="kd">variable</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
<span class="kd">variable</span> <span class="o">(</span><span class="n">xs</span> <span class="n">ys</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>

<span class="c1">-- Simplification rules for reverseAux</span>
<span class="c1">-- ===================================</span>

<span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span>
<span class="kd">lemma</span> <span class="n">reverseAux_nil</span> <span class="o">:</span> <span class="n">reverseAux</span> <span class="o">[]</span> <span class="n">ys</span> <span class="bp">=</span> <span class="n">ys</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span>
<span class="kd">lemma</span> <span class="n">reverseAux_cons</span> <span class="o">:</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">xs</span><span class="o">)</span> <span class="n">ys</span> <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">xs</span> <span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">ys</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="c1">-- Definition and simplification rules for reverse2</span>
<span class="c1">-- ================================================</span>

<span class="kd">def</span> <span class="n">reverse2</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">List</span> <span class="n">α</span>
  <span class="bp">|</span> <span class="o">[]</span>        <span class="bp">=&gt;</span> <span class="o">[]</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="bp">++</span> <span class="o">[</span><span class="n">x</span><span class="o">]</span>

<span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span>
<span class="kd">lemma</span> <span class="n">reverse2_nil</span> <span class="o">:</span>
  <span class="n">reverse2</span> <span class="o">([]</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="o">[]</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span>
<span class="kd">lemma</span> <span class="n">reverse2_cons</span> <span class="o">:</span>
  <span class="n">reverse2</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="bp">++</span> <span class="o">[</span><span class="n">x</span><span class="o">]</span> <span class="o">:=</span>
  <span class="n">rfl</span>

<span class="c1">-- Auxiliary lemma: reverseAux xs ys = (reverse2 xs) ++ ys</span>
<span class="c1">-- =======================================================</span>

<span class="c1">-- Proof 1 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">[]</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">ys</span>                         <span class="o">:=</span> <span class="n">reverseAux_nil</span> <span class="n">ys</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>                   <span class="o">:=</span> <span class="o">(</span><span class="n">nil_append</span> <span class="n">ys</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>          <span class="o">:=</span> <span class="n">congrArg</span> <span class="o">(</span><span class="bp">.</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="n">reverse2_nil.symm</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">as</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>    <span class="o">:=</span> <span class="n">reverseAux_cons</span> <span class="n">a</span> <span class="n">as</span> <span class="n">ys</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>   <span class="o">:=</span> <span class="o">(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">([</span><span class="n">a</span><span class="o">]</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="o">:=</span> <span class="n">congrArg</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="bp">.</span><span class="o">)</span> <span class="n">singleton_append</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span> <span class="o">(</span><span class="n">append_assoc</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span><span class="o">)</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="n">ys</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>   <span class="o">:=</span> <span class="n">congrArg</span> <span class="o">(</span><span class="bp">.</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="o">(</span><span class="n">reverse2_cons</span> <span class="n">a</span> <span class="n">as</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>

<span class="c1">-- Proof 2 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">[]</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">ys</span>                         <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">reverseAux_nil</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>                   <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>          <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">reverse2_nil</span><span class="o">]</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">as</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>    <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">reverseAux_cons</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>   <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">([</span><span class="n">a</span><span class="o">]</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">singleton_append</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">append_assoc</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>   <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">reverse2_cons</span><span class="o">]</span>

<span class="c1">-- Proof 3 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">[]</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">ys</span>                <span class="o">:=</span> <span class="n">rfl</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>          <span class="o">:=</span> <span class="kd">by</span> <span class="n">rfl</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span> <span class="n">rfl</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">as</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>    <span class="o">:=</span> <span class="n">rfl</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>   <span class="o">:=</span> <span class="o">(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">([</span><span class="n">a</span><span class="o">]</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">append_assoc</span><span class="o">]</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>   <span class="o">:=</span> <span class="n">rfl</span>

<span class="c1">-- Proof 4 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">[]</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">ys</span>                         <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>                   <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">[]</span> <span class="bp">++</span> <span class="n">ys</span>          <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">as</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>    <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>   <span class="o">:=</span> <span class="o">(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">([</span><span class="n">a</span><span class="o">]</span> <span class="bp">++</span> <span class="n">ys</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">[</span><span class="n">a</span><span class="o">])</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>   <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>

<span class="c1">-- Proof 5 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="n">simp</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="k">calc</span> <span class="n">reverseAux</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="n">ys</span>
         <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">as</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>    <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">as</span> <span class="bp">++</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)</span>   <span class="o">:=</span> <span class="o">(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))</span>
       <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>   <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>

<span class="c1">-- Proof 6 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="n">simp</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">)]</span>

<span class="c1">-- Proof 7 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">induction'</span> <span class="n">xs</span> <span class="n">generalizing</span> <span class="n">ys</span> <span class="bp">&lt;;&gt;</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">]</span>

<span class="c1">-- Proof 8 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">example</span> <span class="o">:</span>
  <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span> <span class="o">:=</span>
<span class="kd">by</span>
  <span class="n">induction'</span> <span class="n">xs</span> <span class="k">with</span> <span class="n">a</span> <span class="n">as</span> <span class="n">IH</span> <span class="n">generalizing</span> <span class="n">ys</span>
  <span class="bp">.</span> <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux [] ys = reverse2 [] ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">reverseAux_nil</span><span class="o">]</span>
    <span class="c1">-- ⊢ ys = reverse2 [] ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">reverse2_nil</span><span class="o">]</span>
    <span class="c1">-- ⊢ ys = [] ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">]</span>
  <span class="bp">.</span> <span class="c1">-- a : α</span>
    <span class="c1">-- as : List α</span>
    <span class="c1">-- IH : ∀ (ys : List α), reverseAux as ys = reverse2 as ++ ys</span>
    <span class="c1">-- ys : List α</span>
    <span class="c1">-- ⊢ reverseAux (a :: as) ys = reverse2 (a :: as) ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">reverseAux_cons</span><span class="o">]</span>
    <span class="c1">-- ⊢ reverseAux as (a :: ys) = reverse2 (a :: as) ++ ys</span>
    <span class="n">rw</span> <span class="o">[(</span><span class="n">IH</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">ys</span><span class="o">))]</span>
    <span class="c1">-- ⊢ reverse2 as ++ a :: ys = reverse2 (a :: as) ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">reverse2_cons</span><span class="o">]</span>
    <span class="c1">-- ⊢ reverse2 as ++ a :: ys = (reverse2 as ++ [a]) ++ ys</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">append_assoc</span><span class="o">]</span>
    <span class="c1">-- ⊢ reverse2 as ++ a :: ys = reverse2 as ++ ([a] ++ ys)</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">singleton_append</span><span class="o">]</span>

<span class="c1">-- Proof 9 of the auxiliary lemma</span>
<span class="c1">-- ==============================</span>

<span class="kd">@[</span><span class="n">simp</span><span class="kd">]</span>
<span class="kd">lemma</span> <span class="n">reverse2_equiv</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="n">xs</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">ys</span><span class="o">,</span> <span class="n">reverseAux</span> <span class="n">xs</span> <span class="n">ys</span> <span class="bp">=</span> <span class="o">(</span><span class="n">reverse2</span> <span class="n">xs</span><span class="o">)</span> <span class="bp">++</span> <span class="n">ys</span>
<span class="bp">|</span> <span class="o">[]</span>         <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">simp</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">as</span><span class="o">)</span>  <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">reverse2_equiv</span> <span class="n">as</span><span class="o">]</span>

<span class="c1">-- Proofs of the main lemma</span>
<span class="c1">-- ========================</span>

<span class="c1">-- Proof 1</span>
<span class="c1">-- =======</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">reverse</span> <span class="n">xs</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">reverse</span> <span class="n">xs</span>
     <span class="bp">=</span> <span class="n">reverseAux</span> <span class="n">xs</span> <span class="o">[]</span>  <span class="o">:=</span> <span class="n">rfl</span>
   <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="bp">++</span> <span class="o">[]</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">reverse2_equiv</span><span class="o">]</span>
   <span class="n">_</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span>       <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">append_nil</span><span class="o">]</span>

<span class="c1">-- Proof 2</span>
<span class="c1">-- =======</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">reverse</span> <span class="n">xs</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">reverse2_equiv</span><span class="o">,</span> <span class="n">reverse</span><span class="o">]</span>

<span class="c1">-- Proof 3</span>
<span class="c1">-- =======</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">reverse</span> <span class="n">xs</span> <span class="bp">=</span> <span class="n">reverse2</span> <span class="n">xs</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">reverse</span><span class="o">]</span>

<span class="c1">-- Used lemmas</span>
<span class="c1">-- ===========</span>

<span class="c1">-- variable (ys zs : List α)</span>
<span class="c1">-- #check (append_assoc xs ys zs : (xs ++ ys) ++ zs = xs ++ (ys ++ zs))</span>
<span class="c1">-- #check (append_nil xs : xs ++ [] = xs)</span>
<span class="c1">-- #check (nil_append xs : [] ++ xs = xs)</span>
<span class="c1">-- #check (reverse xs = reverseAux xs [])</span>
<span class="c1">-- #check (singleton_append : [x] ++ ys = x :: ys)</span>
</pre></div>

<p>You can interact with the previous proofs at <a href="https://live.lean-lang.org/#url=https://raw.githubusercontent.com/jaalonso/Calculemus2/main/src/Pruebas_de_equivalencia_de_definiciones_de_inversa.lean">Lean 4 Web</a>.</p>
<h2>3. Proofs with Isabelle/HOL</h2>
<div class="code"><pre class="code literal-block"><span class="k">theory</span><span class="w"> </span><span class="n">Pruebas_de_equivalencia_de_definiciones_de_inversa</span>
<span class="kp">imports</span><span class="w"> </span><span class="n">Main</span>
<span class="k">begin</span>

<span class="c">(* Alternative definition *)</span>
<span class="c">(* ====================== *)</span>

<span class="k">fun</span><span class="w"> </span><span class="n">reverse_aux</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list ⇒ 'a list ⇒ 'a list"</span><span class="w"> </span><span class="kp">where</span>
<span class="w">  </span><span class="s">"reverse_aux [] ys     = ys"</span>
<span class="o">|</span><span class="w"> </span><span class="s">"reverse_aux (x#xs) ys = reverse_aux xs (x#ys)"</span>

<span class="k">fun</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list ⇒ 'a list"</span><span class="w"> </span><span class="kp">where</span>
<span class="w">  </span><span class="s">"reverse xs = reverse_aux xs []"</span>

<span class="c">(* Auxiliar lemma: reverse_aux xs ys = (rev xs) @ ys *)</span>
<span class="c">(* ================================================ *)</span>

<span class="c">(* Proof 1 of the auxiliary lemma *)</span>
<span class="kn">lemma</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse_aux [] ys = ys"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">reverse_aux.simps</span><span class="o">(</span><span class="n">1</span><span class="o">))</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = [] @ ys"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">append.simps</span><span class="o">(</span><span class="n">1</span><span class="o">))</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev [] @ ys"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">rev.simps</span><span class="o">(</span><span class="n">1</span><span class="o">))</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux [] ys = rev [] @ ys"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="n">this</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="n n-Type">'a</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">assume</span><span class="w"> </span><span class="n">IH</span><span class="o">:</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux xs ys = rev xs@ys"</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux (a#xs) ys = rev (a#xs)@ys"</span>
<span class="w">  </span><span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = reverse_aux xs (a#ys)"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">reverse_aux.simps</span><span class="o">(</span><span class="n">2</span><span class="o">))</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs@(a#ys)"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">IH</span><span class="o">)</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs @ ([a] @ ys)"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">append.simps</span><span class="o">)</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = (rev xs @ [a]) @ ys"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">append_assoc</span><span class="o">)</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev (a # xs) @ ys"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">only</span><span class="o">:</span><span class="w"> </span><span class="n">rev.simps</span><span class="o">(</span><span class="n">2</span><span class="o">))</span>
<span class="w">    </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = rev (a#xs)@ys"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">this</span>
<span class="w">  </span><span class="k">qed</span>
<span class="k">qed</span>

<span class="c">(* Proof 1 of the auxiliary lemma *)</span>
<span class="kn">lemma</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse_aux [] ys = ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = [] @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev [] @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux [] ys = rev [] @ ys"</span><span class="w"> </span><span class="ow">.</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="n n-Type">'a</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">assume</span><span class="w"> </span><span class="n">IH</span><span class="o">:</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux xs ys = rev xs@ys"</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux (a#xs) ys = rev (a#xs)@ys"</span>
<span class="w">  </span><span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = reverse_aux xs (a#ys)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs@(a#ys)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">IH</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs @ ([a] @ ys)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = (rev xs @ [a]) @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev (a # xs) @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = rev (a#xs)@ys"</span><span class="w"> </span><span class="ow">.</span>
<span class="w">  </span><span class="k">qed</span>
<span class="k">qed</span>

<span class="c">(* Proof 1 of the auxiliary lemma *)</span>
<span class="kn">lemma</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux [] ys = rev [] @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="n n-Type">'a</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">assume</span><span class="w"> </span><span class="n">IH</span><span class="o">:</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux xs ys = rev xs@ys"</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux (a#xs) ys = rev (a#xs)@ys"</span>
<span class="w">  </span><span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="k">fix</span><span class="w"> </span><span class="n">ys</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = rev xs@(a#ys)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">IH</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev (a # xs) @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse_aux (a#xs) ys = rev (a#xs)@ys"</span><span class="w"> </span><span class="ow">.</span>
<span class="w">  </span><span class="k">qed</span>
<span class="k">qed</span>

<span class="c">(* Proof 4 of the auxiliary lemma *)</span>
<span class="kn">lemma</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux [] ys = rev [] @ ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">fix</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="n n-Type">'a</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a list"</span>
<span class="w">  </span><span class="k">assume</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux xs ys = rev xs@ys"</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"⋀ys. reverse_aux (a#xs) ys = rev (a#xs)@ys"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>

<span class="c">(* Proof 5 of the auxiliary lemma *)</span>
<span class="kn">lemma</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">Nil</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Cons</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>

<span class="c">(* Proof 6 of the auxiliary lemma *)</span>
<span class="kn">lemma</span><span class="w"> </span><span class="n">reverse_equiv</span><span class="o">:</span>
<span class="w">  </span><span class="s">"reverse_aux xs ys = (rev xs) @ ys"</span>
<span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span><span class="w"> </span><span class="n">simp_all</span>

<span class="c">(* Proofs of the main lemma *)</span>
<span class="c">(* ======================== *)</span>

<span class="c">(* Proof 1 *)</span>
<span class="kn">lemma</span><span class="w"> </span><span class="s">"reverse xs = rev xs"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse xs = reverse_aux xs []"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">reverse.simps</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = (rev xs) @ []"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">reverse_equiv</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">append.right_neutral</span><span class="o">)</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse xs = rev xs"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="n">this</span>
<span class="k">qed</span>

<span class="c">(* Proof 2 *)</span>
<span class="kn">lemma</span><span class="w"> </span><span class="s">"reverse xs = rev xs"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"reverse xs = reverse_aux xs []"</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = (rev xs) @ []"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">reverse_equiv</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… = rev xs"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="s">"reverse xs = rev xs"</span><span class="w"> </span><span class="ow">.</span>
<span class="k">qed</span>

<span class="c">(* Proof 3 *)</span>
<span class="kn">lemma</span><span class="w"> </span><span class="s">"reverse xs = rev xs"</span>
<span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">reverse_equiv</span><span class="o">)</span>

<span class="k">end</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../14-proofs_of_take_n_xs_%2B%2B_drop_n_xs_eq_xs/" rel="prev" title="Proofs of take n xs ++ drop n xs = xs">Previous post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article></main><footer id="footer"><p>By <a href="https://jaalonso.github.io/">José A. Alonso</a>, created with <a href="https://getnikola.com" rel="nofollow">Nikola</a> <br> This work is licensed under a [Creative Commons Attribution Non Commercial Share Alike 4.0 International](https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.en) 
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a></p>
            
        </footer>
</div>
        

    
    
</body>
</html>
