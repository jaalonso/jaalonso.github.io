<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<!-- 28 de febrero del 2025 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tema 24: Programación dinámica</title>
<meta name="author" content="José A. Alonso" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="../../../css/estilo-org.css" />
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body>
<div id="preamble" class="status">
<p><a href="/"><i class="fa fa-home"></i></a> |
   <a href="/curso-i1m/i1m/">Inicial</a> |
   <a href="/curso-i1m/i1m/temas_apuntes_codigos.html">Temas  </a> |
   <a href="/curso-i1m/i1m/manuales.html">Manuales  </a> |
   <a href="/curso-i1m/i1m/ejercicios.html">Ejercicios  </a> |
   <a href="/curso-i1m/i1m/examenes.html">Exámenes  </a> |
   <a href="/curso-i1m/i1m/doc.html">Documentación  </a>
</p>
</div>
<div id="content" class="content">
<h1 class="title">Tema 24: Programación dinámica</h1>
<div id="table-of-contents" role="doc-toc">
<h2>&Iacute;ndice</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgbd6be9b">1. Programación dinámica</a>
<ul>
<li><a href="#org20b5f88">1.1. Introducción a la programación dinámica</a></li>
<li><a href="#org8db292a">1.2. El patrón de la programación dinámica</a></li>
</ul>
</li>
<li><a href="#org6168f2e">2. Fibonacci como ejemplo de programación dinámica</a>
<ul>
<li><a href="#orgf6e0262">2.1. Definición de Fibonacci mediante programación dinámica</a></li>
</ul>
</li>
<li><a href="#org82ee90a">3. Producto de cadenas de matrices (PCM)</a>
<ul>
<li><a href="#org366dd72">3.1. Descripción del problema PCM</a></li>
<li><a href="#org768aa26">3.2. El algoritmo del PCM</a></li>
<li><a href="#orgb51f111">3.3. Solución del PCM mediante programación dinámica</a></li>
<li><a href="#org4a04ca4">3.4. Solución del PCM mediante divide y vencerás</a></li>
</ul>
</li>
<li><a href="#org41dd244">4. Caminos mínimos entre todos los pares de nodos de un grafo(CM)</a>
<ul>
<li><a href="#org4e2d2d8">4.1. Descripción del problema</a></li>
<li><a href="#org84dd00d">4.2. Solución del problema de los caminos mínimos (CM)</a></li>
</ul>
</li>
<li><a href="#orgb9e51ba">5. Problema del viajante (PV)</a>
<ul>
<li><a href="#orgbea577c">5.1. Solución del problema del viajante (PV)</a></li>
</ul>
</li>
<li><a href="#org267b9d8">6. Material complementario</a>
<ul>
<li><a href="#orgefa09a6">6.1. Bibliografía</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgbd6be9b" class="outline-2">
<h2 id="orgbd6be9b"><span class="section-number-2">1.</span> Programación dinámica</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org20b5f88" class="outline-3">
<h3 id="org20b5f88"><span class="section-number-3">1.1.</span> Introducción a la programación dinámica</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>Inconveniente de la técnica divide y vencerás: la posibilidad de crear
idénticos supbroblemas y repetición del trabajo.</li>

<li>Idea de la programación dinámica: resolver primero los subproblemas menores,
guardar los resultados y usar los resultados de los subproblemas intermedios
para resolver los mayores.</li>

<li><p>
Definición de Fibonacci por divide y vencerás.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">fib</span> 0 <span style="color: #a0522d;">=</span> 0
<span style="color: #0000ff;">fib</span> 1 <span style="color: #a0522d;">=</span> 1
<span style="color: #0000ff;">fib</span> n <span style="color: #a0522d;">=</span> fib <span style="color: #707183;">(</span>n<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span> <span style="color: #a0522d;">+</span> fib <span style="color: #707183;">(</span>n<span style="color: #a0522d;">-</span>2<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
Cálculo de <code>(fib 4)</code> por divide y vencerás
</p>
<pre class="example">
                      fib 4
                     /     \
              +-----+       +--+
              |                |
            fib 3             fib 2
           /     \           /     \
      fib 2       fib 1 fib 1       fib 0
     /     \
fib 1       fib 0
</pre>

<p>
Calcula 2 veces (fib 2) y 3 veces (fib 1) y (fib 0).&lt;/p&gt;
</p></li>

<li><p>
Cálculo de <code>(fib 4)</code> por programación dinámica
</p>
<pre class="example">
fib 0
 |    fib 1
 |     |
 +-----+=== fib 2
       |     |
       +-----+=== fib 3
             |     |
             +-----+=== fib 4
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org8db292a" class="outline-3">
<h3 id="org8db292a"><span class="section-number-3">1.2.</span> El patrón de la programación dinámica</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li><p>
Cabecera del módulo:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">module</span> <span style="color: #228b22;">Dinamica</span> <span style="color: #707183;">(</span><span style="color: #a020f0;">module</span> <span style="color: #228b22;">Tabla</span>, dinamica<span style="color: #707183;">)</span>  <span style="color: #a020f0;">where</span>
</pre>
</div></li>

<li><p>
Librerías auxiliares
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #b22222;">-- </span><span style="color: #b22222;">Hay que elegir una implementaci&#243;n de TAD Tabla</span>
<span style="color: #b22222;">-- </span><span style="color: #b22222;">import TablaConFunciones as Tabla</span>
<span style="color: #a020f0;">import</span> <span style="color: #228b22;">TablaConListasDeAsociacion</span> <span style="color: #a020f0;">as</span> <span style="color: #228b22;">Tabla</span>
<span style="color: #b22222;">-- </span><span style="color: #b22222;">import TablaConMatrices as Tabla</span>

<span style="color: #a020f0;">import</span> <span style="color: #228b22;">Data.Array</span>
</pre>
</div></li>

<li><p>
El patrón de la programación dinámica
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">dinamica</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Ix</span> i <span style="color: #a0522d;">=&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Tabla</span> i v <span style="color: #a0522d;">-&gt;</span> i <span style="color: #a0522d;">-&gt;</span> v<span style="color: #707183;">)</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span>i,i<span style="color: #707183;">)</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Tabla</span> i v
<span style="color: #0000ff;">dinamica</span> calcula cotas <span style="color: #a0522d;">=</span> t
  <span style="color: #a020f0;">where</span> t <span style="color: #a0522d;">=</span> tabla <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span>i,calcula t i<span style="color: #7388d6;">)</span> <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> range cotas<span style="color: #707183;">]</span>
</pre>
</div></li>

<li>Notas:
<ul class="org-ul">
<li><code>(calcula t i)</code> es el valor del índice <code>i</code> calculado a partir de los
anteriores que ya se encuentran en la tabla <code>t</code>.</li>
<li><code>cotas</code> son las cotas de la matriz <code>t</code> en la que se almacenan los valores
calculados.</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org6168f2e" class="outline-2">
<h2 id="org6168f2e"><span class="section-number-2">2.</span> Fibonacci como ejemplo de programación dinámica</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgf6e0262" class="outline-3">
<h3 id="orgf6e0262"><span class="section-number-3">2.1.</span> Definición de Fibonacci mediante programación dinámica</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li><p>
Importación del patrón de programación dinámica
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">import</span> <span style="color: #228b22;">Dinamica</span>
</pre>
</div></li>

<li><p>
<code>(fib n)</code> es el n-ésimo término de la sucesión de Fibonacci, calculado
mediante programación dinámica. Por ejemplo,
</p>
<pre class="example">
fib 8  ==  21
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">fib</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">fib</span> n <span style="color: #a0522d;">=</span> valor t n
  <span style="color: #a020f0;">where</span> t <span style="color: #a0522d;">=</span> dinamica calculaFib <span style="color: #707183;">(</span>cotasFib n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(calculaFib t i)</code> es el valor de i-ésimo término de la sucesión de Fibonacci
calculado mediante la tabla t que contiene los anteriores. Por ejemplo,
</p>
<pre class="example">
calculaFib (tabla []) 0                       == 0
calculaFib (tabla [(0,0),(1,1),(2,1),(3,2)] 4 == 3
</pre>

<p>
Además,
</p>
<pre class="example">
λ&gt; dinamica calculaFib (0,6)
Tbl [(0,0),(1,1),(2,1),(3,2),(4,3),(5,5),(6,8)]
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">calculaFib</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Tabla</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">calculaFib</span> t i
 <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;=</span> 1    <span style="color: #a0522d;">=</span> i
 <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span> <span style="color: #a0522d;">+</span> valor t <span style="color: #707183;">(</span>i<span style="color: #a0522d;">-</span>2<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(cotasFib n)</code> son las cotas del vector que se necesita para calcular el
n-ésimo término de la sucesión de Fibonacci mediante programación dinámica.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cotasFib</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">cotasFib</span> n <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>0,n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(fibR n)</code> es el n-ésimo término de la sucesión de Fibonacci calculado
mediante divide y vencerás.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">fibR</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">fibR</span> 0 <span style="color: #a0522d;">=</span> 0
<span style="color: #0000ff;">fibR</span> 1 <span style="color: #a0522d;">=</span> 1
<span style="color: #0000ff;">fibR</span> n <span style="color: #a0522d;">=</span> fibR <span style="color: #707183;">(</span>n<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span> <span style="color: #a0522d;">+</span> fibR <span style="color: #707183;">(</span>n<span style="color: #a0522d;">-</span>2<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
Comparación:
</p>
<pre class="example">
λ&gt; fib 30
832040
(0.01 secs, 0 bytes)
λ&gt; fibR 30
832040
(6.46 secs, 222602404 bytes)
</pre></li>

<li><p>
<code>fibs</code> es la lista de los términos de la sucesión de Fibonacci. Por ejemplo,
</p>
<pre class="example">
take 10 fibs  ==  [0,1,1,2,3,5,8,13,21,34]
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">fibs</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">fibs</span> <span style="color: #a0522d;">=</span> 0<span style="color: #228b22;">:</span>1<span style="color: #228b22;">:</span><span style="color: #707183;">[</span>x<span style="color: #a0522d;">+</span>y <span style="color: #a0522d;">|</span> <span style="color: #7388d6;">(</span>x,y<span style="color: #7388d6;">)</span> <span style="color: #a0522d;">&lt;-</span> zip fibs <span style="color: #7388d6;">(</span>tail fibs<span style="color: #7388d6;">)</span><span style="color: #707183;">]</span>
</pre>
</div></li>

<li><p>
<code>(fib' n)</code> es el n-ésimo término de la sucesión de Fibonacci, calculado a
partir de fibs. Por ejemplo,
</p>
<pre class="example">
fib' 8  ==  21
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">fib'</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">fib'</span> n <span style="color: #a0522d;">=</span> fibs<span style="color: #a0522d;">!!</span>n
</pre>
</div></li>

<li><p>
Comparaciones:
</p>
<pre class="example">
λ&gt; fib 30
832040
(0.02 secs, 524808 bytes)
λ&gt; fib' 30
832040
(0.01 secs, 542384 bytes)
λ&gt; fibR 30
832040
(6.46 secs, 222602404 bytes)
</pre></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org82ee90a" class="outline-2">
<h2 id="org82ee90a"><span class="section-number-2">3.</span> Producto de cadenas de matrices (PCM)</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org366dd72" class="outline-3">
<h3 id="org366dd72"><span class="section-number-3">3.1.</span> Descripción del problema PCM</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>Para multiplicar una matriz de orden m x p y otra de orden p x n se necesitan
m x n x p multiplicaciones de elementos.</li>

<li>El problema del producto de una cadena de matrices (en inglés, "matrix chain
multiplication") consiste en dada una sucesión de matrices encontrar la
manera de multiplicarlas usando el menor número de productos de elementos.</li>

<li><p>
Ejemplo: Dada la sucesión de matrices
</p>
<pre class="example">
A (30 x 1), B (1 x 40), C (40 x 10), D (10 x 25)
</pre>

<p>
las productos necesarios en las posibles asociaciones son
</p>
<pre class="example">
((AB)C)D  30 x  1 x 40 + 30 x 40 x 10 + 30 x 10 x 25 = 20700
A(B(CD))  40 x 10 x 25 +  1 x 40 x 25 + 30 x  1 x 25 = 11750
(AB)(CD)  30 x  1 x 40 + 40 x 10 x 25 + 30 x 40 x 25 = 41200
A((BC)D)   1 x 40 x 10 +  1 x 10 x 25 + 30 x  1 x 25 =  1400
(A(BC))D   1 x 40 x 10 + 30 x  1 x 10 + 30 x 10 x 25 =  8200
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org768aa26" class="outline-3">
<h3 id="org768aa26"><span class="section-number-3">3.2.</span> El algoritmo del PCM</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>El PCM correspondiente a la sucesión d(0), &#x2026;, d(n) consiste en encontrar la
manera de multiplicar una sucesión de matrices A(1), &#x2026;, A(n) (tal que el
orden de A(i) es d(i-1) x d(i)) usando el menor número de productos de
elementos.</li>

<li>Sea c(i,j) el mínimo número de multiplicaciones necesarias para
multiplicar la cadena A(i), &#x2026;, A(j) (1 ≤ i ≤ j ≤ n).</li>

<li><p>
Relación de recurrencia de c(i,j):
</p>
<pre class="example">
c(i,i) = 0
c(i,j) = minimo {c(i,k)+c(k+1,j)+d(i-1)*d(k)*d(j) | i ≤ k &lt; j}
</pre></li>

<li>La solución del problema es c(1,n).</li>
</ul>


<div id="org0da6d69" class="figure">
<p><img src="./fig/PCM.png" alt="PCM.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb51f111" class="outline-3">
<h3 id="orgb51f111"><span class="section-number-3">3.3.</span> Solución del PCM mediante programación dinámica</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li><p>
Importación de librerías auxiliares:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">import</span> <span style="color: #228b22;">Dinamica</span>
</pre>
</div></li>

<li><p>
<code>Cadena</code> representa el producto de una cadena de matrices. Por ejemplo,
</p>
<pre class="example">
P (A 1) (P (A 2) (A 3))  ==  (A1*(A2*A3))
P (P (A 1) (A 2)) (A 3)  ==  ((A1*A2)*A3)
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">data</span> <span style="color: #228b22;">Cadena</span> <span style="color: #a0522d;">=</span> <span style="color: #228b22;">A</span> <span style="color: #228b22;">Int</span>
            <span style="color: #a0522d;">|</span> <span style="color: #228b22;">P</span> <span style="color: #228b22;">Cadena</span> <span style="color: #228b22;">Cadena</span>

<span style="color: #a020f0;">instance</span> <span style="color: #228b22;">Show</span> <span style="color: #228b22;">Cadena</span> <span style="color: #a020f0;">where</span>
  show <span style="color: #707183;">(</span><span style="color: #228b22;">A</span> x<span style="color: #707183;">)</span>     <span style="color: #a0522d;">=</span> <span style="color: #8b2252;">"A"</span> <span style="color: #a0522d;">++</span> show x
  show <span style="color: #707183;">(</span><span style="color: #228b22;">P</span> p1 p2<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> concat <span style="color: #707183;">[</span><span style="color: #8b2252;">"("</span>,show p1,<span style="color: #8b2252;">"*"</span>,show p2,<span style="color: #8b2252;">")"</span><span style="color: #707183;">]</span>
</pre>
</div></li>

<li><p>
Los índices de la matriz de cálculo son de la forma <code>(i,j)</code> y sus valores
<code>(v,k)</code> donde <code>v</code> es el mínimo número de multiplicaciones necesarias para
multiplicar la cadena A(i), &#x2026;,A(j) y <code>k</code> es la posición donde dividir la
cadena de forma óptima.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">type</span> <span style="color: #228b22;">IndicePCM</span> <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #707183;">)</span>
<span style="color: #a020f0;">type</span> <span style="color: #228b22;">ValorPCM</span>  <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(pcm ds)</code> es el par formado por el mínimo número de multiplicaciones
elementales para multiplicar una sucesión de matrices A(1), &#x2026;, A(n) (tal
que el orden de A(i) es d(i-1) x d(i) y ds = [d(0), &#x2026;,d(n)]). Por ejemplo,
</p>
<pre class="example">
pcm [30,1,40,10,25]  == (1400,(A1*((A2*A3)*A4)))
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">pcm</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>, <span style="color: #228b22;">Cadena</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">pcm</span> ds <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v, cadena t 1 n<span style="color: #707183;">)</span>
  <span style="color: #a020f0;">where</span> n     <span style="color: #a0522d;">=</span> length ds <span style="color: #a0522d;">-</span> 1
        t     <span style="color: #a0522d;">=</span> dinamica <span style="color: #707183;">(</span>calculaPCM ds<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cotasPCM n<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>v,<span style="color: #a020f0;">_</span><span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>1,n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(calculaPCM ds t (i,j))</code> es el valor del índice <code>(i,j)</code> calculado a partir
de la lista <code>ds</code> de dimensiones de las matrices y la tabla <code>t</code> de valores
previamente calculados.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">calculaPCM</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Tabla</span> <span style="color: #228b22;">IndicePCM</span> <span style="color: #228b22;">ValorPCM</span>
              <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">IndicePCM</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">ValorPCM</span>
<span style="color: #0000ff;">calculaPCM</span> ds t <span style="color: #707183;">(</span>i,j<span style="color: #707183;">)</span>
    <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">==</span> j    <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>0,i<span style="color: #707183;">)</span>
    <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span>
         minimum <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span>fst<span style="color: #909183;">(</span>valor t <span style="color: #709870;">(</span>i,k<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                  <span style="color: #a0522d;">+</span> fst<span style="color: #909183;">(</span>valor t <span style="color: #709870;">(</span>k<span style="color: #a0522d;">+</span>1,j<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                  <span style="color: #a0522d;">+</span> ds<span style="color: #a0522d;">!!</span><span style="color: #909183;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span> <span style="color: #a0522d;">*</span> ds<span style="color: #a0522d;">!!</span>k <span style="color: #a0522d;">*</span> ds<span style="color: #a0522d;">!!</span>j, k<span style="color: #7388d6;">)</span>
                  <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>i<span style="color: #a0522d;">..</span>j<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
</pre>
</div></li>

<li><p>
<code>(cotasPCM n)</code> son las cotas de los índices para el producto de una cadena de
n matrices.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cotasPCM</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">IndicePCM</span>,<span style="color: #228b22;">IndicePCM</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">cotasPCM</span> n <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span>1,1<span style="color: #7388d6;">)</span>,<span style="color: #7388d6;">(</span>n,n<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(cadena t i j)</code> es la cadena que resultar de agrupar las matrices
A(i), &#x2026;, A(j) según los valores de la tabla <code>t</code>.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cadena</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Tabla</span> <span style="color: #228b22;">IndicePCM</span> <span style="color: #228b22;">ValorPCM</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Cadena</span>
<span style="color: #0000ff;">cadena</span> t i j
    <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">==</span> j<span style="color: #a0522d;">-</span>1  <span style="color: #a0522d;">=</span> <span style="color: #228b22;">P</span> <span style="color: #707183;">(</span><span style="color: #228b22;">A</span> i<span style="color: #707183;">)</span> <span style="color: #707183;">(</span><span style="color: #228b22;">A</span> j<span style="color: #707183;">)</span>
    <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">==</span> i    <span style="color: #a0522d;">=</span> <span style="color: #228b22;">P</span> <span style="color: #707183;">(</span><span style="color: #228b22;">A</span> i<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cadena t <span style="color: #7388d6;">(</span>i<span style="color: #a0522d;">+</span>1<span style="color: #7388d6;">)</span> j<span style="color: #707183;">)</span>
    <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">==</span> j<span style="color: #a0522d;">-</span>1  <span style="color: #a0522d;">=</span> <span style="color: #228b22;">P</span> <span style="color: #707183;">(</span>cadena t i <span style="color: #7388d6;">(</span>j<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span><span style="color: #228b22;">A</span> j<span style="color: #707183;">)</span>
    <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> <span style="color: #228b22;">P</span> <span style="color: #707183;">(</span>cadena t i <span style="color: #7388d6;">(</span>k<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cadena t k j<span style="color: #707183;">)</span>
    <span style="color: #a020f0;">where</span> <span style="color: #707183;">(</span><span style="color: #a020f0;">_</span>,k<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>i,j<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(pcm' ds)</code> es la lista de los índices y valores usados en el cálculo del
mínimo número de multiplicaciones necesarias para multiplicar una sucesión
de matrices A(1), &#x2026;,A(n) (tal que el orden de A(i) es d(i-1) x d(i) y
ds = [d(0), &#x2026;, d(n)]). Por ejemplo,
</p>
<pre class="example">
λ&gt; pcm' [30,1,40,10,25]
[((1,1),(0,1)),((1,2),(1200,1)),((1,3),(700,1)),((1,4),(1400,1)),
 ((2,2),(0,2)),((2,3),(400,2)),((2,4),(650,3)),
 ((3,3),(0,3)),((3,4),(10000,3)),
 ((4,4),(0,4))]
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">pcm'</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #909183;">(</span><span style="color: #228b22;">Int</span>, <span style="color: #228b22;">Int</span><span style="color: #909183;">)</span>, <span style="color: #228b22;">ValorPCM</span><span style="color: #7388d6;">)</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">pcm'</span> ds <span style="color: #a0522d;">=</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #909183;">(</span>i,j<span style="color: #909183;">)</span>,valor t <span style="color: #909183;">(</span>i,j<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span> <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>n<span style="color: #7388d6;">]</span>, j <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>i<span style="color: #a0522d;">..</span>n<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
    <span style="color: #a020f0;">where</span> n <span style="color: #a0522d;">=</span> length ds <span style="color: #a0522d;">-</span> 1
          t <span style="color: #a0522d;">=</span> dinamica <span style="color: #707183;">(</span>calculaPCM ds<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cotasPCM n<span style="color: #707183;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org4a04ca4" class="outline-3">
<h3 id="org4a04ca4"><span class="section-number-3">3.4.</span> Solución del PCM mediante divide y vencerás</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li><p>
<code>(pcmDyV ds)</code> es la solución del PCM correspondiente a <code>ds</code> mediante divide y
vencerás. Por ejemplo,
</p>
<pre class="example">
pcmDyV [30,1,40,10,25]  ==  (1040,(A1*((A2*A3)*A4)))
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">pcmDyV</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>, <span style="color: #228b22;">Cadena</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">pcmDyV</span> ds <span style="color: #a0522d;">=</span> cadenaDyV ds 1 n
  <span style="color: #a020f0;">where</span> n <span style="color: #a0522d;">=</span> length ds <span style="color: #a0522d;">-</span> 1
</pre>
</div></li>

<li><p>
<code>cadenaDyV ds i j)</code> es la solución del PCM correspondiente a
[d(i), &#x2026;, d(j)]. Por ejemplo,
</p>
<pre class="example">
cadenaDyV [30,1,40,10,25] 1 4  ==  (1040,(A1*((A2*A3)*A4)))
cadenaDyV [30,1,40,10,25] 2 4  ==  (650,((A2*A3)*A4))
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cadenaDyV</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>, <span style="color: #228b22;">Cadena</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">cadenaDyV</span> ds i j
  <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">==</span> j    <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>0, <span style="color: #228b22;">A</span> i<span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">==</span> j<span style="color: #a0522d;">-</span>1  <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>ds<span style="color: #a0522d;">!!</span><span style="color: #7388d6;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">)</span><span style="color: #a0522d;">*</span>ds<span style="color: #a0522d;">!!</span>i<span style="color: #a0522d;">*</span>ds<span style="color: #a0522d;">!!</span>j, <span style="color: #228b22;">P</span> <span style="color: #7388d6;">(</span><span style="color: #228b22;">A</span> i<span style="color: #7388d6;">)</span> <span style="color: #7388d6;">(</span><span style="color: #228b22;">A</span> j<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">==</span> i    <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v, <span style="color: #228b22;">P</span> <span style="color: #7388d6;">(</span><span style="color: #228b22;">A</span> i<span style="color: #7388d6;">)</span> <span style="color: #7388d6;">(</span>subcadena <span style="color: #909183;">(</span>i<span style="color: #a0522d;">+</span>1<span style="color: #909183;">)</span> j<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">==</span> j<span style="color: #a0522d;">-</span>1  <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v, <span style="color: #228b22;">P</span> <span style="color: #7388d6;">(</span>subcadena i <span style="color: #909183;">(</span>j<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span> <span style="color: #7388d6;">(</span><span style="color: #228b22;">A</span> j<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v, <span style="color: #228b22;">P</span> <span style="color: #7388d6;">(</span>subcadena i <span style="color: #909183;">(</span>k<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span> <span style="color: #7388d6;">(</span>subcadena k j<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
  <span style="color: #a020f0;">where</span> <span style="color: #707183;">(</span>v,k<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> minimum <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #909183;">(</span>valor i k<span style="color: #909183;">)</span>
                          <span style="color: #a0522d;">+</span> <span style="color: #909183;">(</span>valor <span style="color: #709870;">(</span>k<span style="color: #a0522d;">+</span>1<span style="color: #709870;">)</span> j<span style="color: #909183;">)</span>
                          <span style="color: #a0522d;">+</span> ds<span style="color: #a0522d;">!!</span><span style="color: #909183;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span> <span style="color: #a0522d;">*</span> ds<span style="color: #a0522d;">!!</span>k <span style="color: #a0522d;">*</span> ds<span style="color: #a0522d;">!!</span>j, k<span style="color: #7388d6;">)</span>
                         <span style="color: #a0522d;">|</span> k <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>i<span style="color: #a0522d;">..</span>j<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
        valor p q     <span style="color: #a0522d;">=</span> fst <span style="color: #707183;">(</span>cadenaDyV ds p q<span style="color: #707183;">)</span>
        subcadena p q <span style="color: #a0522d;">=</span> snd <span style="color: #707183;">(</span>cadenaDyV ds p q<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
Comparación de las métodos de solucionar el PCM
</p>
<pre class="example">
λ&gt; :set +s

λ&gt; fst (pcm [1..20])
2658
(0.04 secs, 4144552 bytes)

λ&gt; fst (pcmDyV [1..20])
2658
(1582.60 secs, 340414297896 bytes)
</pre></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org41dd244" class="outline-2">
<h2 id="org41dd244"><span class="section-number-2">4.</span> Caminos mínimos entre todos los pares de nodos de un grafo(CM)</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org4e2d2d8" class="outline-3">
<h3 id="org4e2d2d8"><span class="section-number-3">4.1.</span> Descripción del problema</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>Cálculo de los caminos de coste mínimo entre todos los pares de nodos de un
grafo no dirigido.</li>

<li>Notación:
<ul class="org-ul">
<li>c(i,j) es el mínimo coste del camino del vértice i al j.</li>
<li>p(i,j) =
<ul class="org-ul">
<li>0, si i = j</li>
<li>peso del arco entre i y j, si i ≠ j y hay arco de i a j</li>
<li>∞, en otro caso</li>
</ul></li>
<li>c(i,j,k) es el mínimo coste del camino del vértice i al j, usando los
vértices 1, &#x2026;,k.</li>
</ul></li>

<li>Relación de recurrencia para calcular c(i,j):
<ul class="org-ul">
<li>c(i,j,0) = p(i,j)</li>
<li>c(i,j,k) = min {c(i,j,k-1)), c(i,k,k-1)+c(k,j,k-1)}</li>
</ul></li>

<li>El algoritmo se conoce como el algoritmo de Floyd.</li>
</ul>
</div>
</div>

<div id="outline-container-org84dd00d" class="outline-3">
<h3 id="org84dd00d"><span class="section-number-3">4.2.</span> Solución del problema de los caminos mínimos (CM)</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li><p>
Importación de librerías auxiliares:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">import</span> <span style="color: #228b22;">Dinamica</span>

<span style="color: #b22222;">-- </span><span style="color: #b22222;">Nota: Elegir una implementaci&#243;n de los grafos.</span>
<span style="color: #a020f0;">import</span> <span style="color: #228b22;">GrafoConVectorDeAdyacencia</span>
<span style="color: #b22222;">-- </span><span style="color: #b22222;">import GrafoConMatrizDeAdyacencia</span>
</pre>
</div></li>

<li><p>
Ejemplos de grafos para el problema:
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">ej1Grafo</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">ej1Grafo</span> <span style="color: #a0522d;">=</span> creaGrafo <span style="color: #228b22;">True</span> <span style="color: #707183;">(</span>1,6<span style="color: #707183;">)</span>
                     <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span>i,j,<span style="color: #909183;">(</span>v<span style="color: #a0522d;">!!</span><span style="color: #709870;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #a0522d;">!!</span><span style="color: #909183;">(</span>j<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
                      <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span>, j <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>

<span style="color: #0000ff;">v</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">v</span> <span style="color: #a0522d;">=</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span>  0,  4,  1,  6,100,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  4,  0,  1,100,  5,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  1,  1,  0,100,  8,  2<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  6,100,100,  0,100,  2<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>100,  5,  8,100,  0,  5<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>100,100,  2,  2,  5,  0<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>

<span style="color: #0000ff;">ej2Grafo</span> <span style="color: #a0522d;">=</span> creaGrafo <span style="color: #228b22;">True</span> <span style="color: #707183;">(</span>1,6<span style="color: #707183;">)</span>
                     <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span>i,j,<span style="color: #909183;">(</span>v'<span style="color: #a0522d;">!!</span><span style="color: #709870;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #a0522d;">!!</span><span style="color: #909183;">(</span>j<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
                     <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span>, j <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>

<span style="color: #0000ff;">v'</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">v'</span> <span style="color: #a0522d;">=</span><span style="color: #707183;">[</span><span style="color: #7388d6;">[</span>  0,  4,100,100,100,  2<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  1,  0,  3,  4,100,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  6,  3,  0,  7,100,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>  6,100,100,  0,  2,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>100,100,100,  5,  0,100<span style="color: #7388d6;">]</span>,
     <span style="color: #7388d6;">[</span>100,100,100,  2,  3,  0<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
</pre>
</div></li>

<li><p>
En la matriz del cálculo del camino mínimo, los índices son de la forma
<code>(i,j,k)</code> y los valores de la forma <code>(v,xs)</code> representando que el camino
mínimo desde el vértice <code>i</code> al <code>j</code> usando los vértices <code>1</code>, &#x2026;, <code>k</code> tiene un
coste <code>v</code> y está fomado por los vértices <code>xs</code>.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">type</span> <span style="color: #228b22;">IndiceCM</span> <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #707183;">)</span>
<span style="color: #a020f0;">type</span> <span style="color: #228b22;">ValorCM</span>  <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(caminosMinimos g)</code> es la lista de los caminos mínimos entre todos los nodos
del grafo <code>g</code> junto con sus costes. Por ejemplo,
</p>
<pre class="example">
λ&gt; caminosMinimos ej1Grafo
[((1,2),(2,[1,3,2])),  ((1,3),(1,[1,3])),  ((1,4),(5,[1,3,6,4])),
 ((1,5),(7,[1,3,2,5])),((1,6),(3,[1,3,6])),((2,3),(1,[2,3])),
 ((2,4),(5,[2,3,6,4])),((2,5),(5,[2,5])),  ((2,6),(3,[2,3,6])),
 ((3,4),(4,[3,6,4])),  ((3,5),(6,[3,2,5])),((3,6),(2,[3,6])),
 ((4,5),(7,[4,6,5])),  ((4,6),(2,[4,6])),  ((5,6),(5,[5,6]))]
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">caminosMinimos</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span><span style="color: #707183;">)</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #909183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #909183;">)</span>, <span style="color: #228b22;">ValorCM</span><span style="color: #7388d6;">)</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">caminosMinimos</span> g <span style="color: #a0522d;">=</span>
  <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #909183;">(</span>i,j<span style="color: #909183;">)</span>, valor t <span style="color: #909183;">(</span>i,j,n<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span> <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>n<span style="color: #7388d6;">]</span>, j <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>i<span style="color: #a0522d;">+</span>1<span style="color: #a0522d;">..</span>n<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
  <span style="color: #a020f0;">where</span> n <span style="color: #a0522d;">=</span> length <span style="color: #707183;">(</span>nodos g<span style="color: #707183;">)</span>
        t <span style="color: #a0522d;">=</span> dinamica <span style="color: #707183;">(</span>calculaCM g<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cotasCM n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(calculaCM g t (i,j,k))</code> es el valor del camino mínimo desde el vértice <code>i</code>
al <code>j</code> usando los vértices <code>1</code>, &hellip;, <code>k</code> del grafo <code>g</code> y la tabla <code>t</code> de
los valores anteriores al índice <code>(i,j,k)</code>.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">calculaCM</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span><span style="color: #707183;">)</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Tabla</span> <span style="color: #228b22;">IndiceCM</span> <span style="color: #228b22;">ValorCM</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">IndiceCM</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">ValorCM</span>
<span style="color: #0000ff;">calculaCM</span> g t <span style="color: #707183;">(</span>i,j,k<span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> k<span style="color: #a0522d;">==</span>0      <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>peso i j g, <span style="color: #a020f0;">if</span> i<span style="color: #a0522d;">==</span>j <span style="color: #a020f0;">then</span> <span style="color: #7388d6;">[</span>i<span style="color: #7388d6;">]</span> <span style="color: #a020f0;">else</span> <span style="color: #7388d6;">[</span>i,j<span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> v1<span style="color: #a0522d;">&lt;=</span>v2    <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v1,p<span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v2,p1<span style="color: #a0522d;">++</span>p2<span style="color: #707183;">)</span>
  <span style="color: #a020f0;">where</span> <span style="color: #707183;">(</span>v1,p<span style="color: #707183;">)</span>   <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>i,j,k<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>a,p1<span style="color: #707183;">)</span>   <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>i,k,k<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span>
        <span style="color: #707183;">(</span>b,<span style="color: #a020f0;">_</span><span style="color: #228b22;">:</span>p2<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>k,j,k<span style="color: #a0522d;">-</span>1<span style="color: #707183;">)</span>
        v2 <span style="color: #a0522d;">=</span> a<span style="color: #a0522d;">+</span>b
</pre>
</div></li>

<li><p>
<code>(cotasCM n)</code> son las cotas de la matriz para resolver el problema de los
caminos mínimos en un grafo con <code>n</code> nodos.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cotasCM</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #7388d6;">)</span>,<span style="color: #7388d6;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Int</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">cotasCM</span> n <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span>1,1,0<span style="color: #7388d6;">)</span>,<span style="color: #7388d6;">(</span>n,n,n<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgb9e51ba" class="outline-2">
<h2 id="orgb9e51ba"><span class="section-number-2">5.</span> Problema del viajante (PV)</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>Dado un grafo no dirigido con pesos encontrar una camino en el grafo que
visite todos los nodos exactamente una vez y cuyo coste sea mínimo.</li>

<li>Notación:
<ul class="org-ul">
<li>Los vértices del grafo son 1,2, &#x2026;,n.</li>
<li>p(i,j) =
<ul class="org-ul">
<li>0, si i = j</li>
<li>peso del arco entre i y j, si i ≠ j y hay arco de i a j</li>
<li>∞, en otro caso</li>
</ul></li>
<li>El vértice inicial y final es el n.</li>
<li>c(i,S) es el camino más corto que comienza en i, termina en n y pasa
exactamente una vez por cada uno de los vértices del conjunto S.</li>
</ul></li>

<li>Relación de recurrencia de c(i,S):
<ul class="org-ul">
<li>c(i,∅) = p(i,n(, si i ≠ n.</li>
<li>c(i,S) = min {p(i,j)+c_(j,S-{j}} : j ∈ S}, si i ≠ n, i ∉ S.</li>
</ul></li>

<li>La solución es c(n,{1,&#x2026;,n-1}}.</li>
</ul>
</div>

<div id="outline-container-orgbea577c" class="outline-3">
<h3 id="orgbea577c"><span class="section-number-3">5.1.</span> Solución del problema del viajante (PV)</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li><p>
Importación de librerías auxiliares
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">import</span> <span style="color: #228b22;">Dinamica</span>

<span style="color: #b22222;">-- </span><span style="color: #b22222;">Nota: Elegir una implementaci&#243;n de los grafos.</span>
<span style="color: #a020f0;">import</span> <span style="color: #228b22;">GrafoConVectorDeAdyacencia</span>
<span style="color: #b22222;">-- </span><span style="color: #b22222;">import GrafoConMatrizDeAdyacencia</span>
</pre>
</div></li>

<li>Nota: Para el PV se usará la representación de los de conjuntos de enteros
como números enteros que se describe a continuación.</li>

<li><p>
Los conjuntos se representan por números enteros.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">type</span> <span style="color: #228b22;">Conj</span> <span style="color: #a0522d;">=</span> <span style="color: #228b22;">Int</span>
</pre>
</div></li>

<li><p>
<code>(conj2Lista c)</code> es la lista de los elementos del conjunto <code>c</code>. Por ejemplo,
</p>
<pre class="example">
conj2Lista 24  ==  [3,4]
conj2Lista 30  ==  [1,2,3,4]
conj2Lista 22  ==  [1,2,4]
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">conj2Lista</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Conj</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">[</span><span style="color: #228b22;">Int</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">conj2Lista</span> s <span style="color: #a0522d;">=</span> c2l s 0
  <span style="color: #a020f0;">where</span>
    c2l 0 <span style="color: #a020f0;">_</span>             <span style="color: #a0522d;">=</span> <span style="color: #707183;">[]</span>
    c2l n i <span style="color: #a0522d;">|</span> odd n     <span style="color: #a0522d;">=</span> i <span style="color: #228b22;">:</span> c2l <span style="color: #707183;">(</span>n <span style="color: #a0522d;">`div`</span> 2<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>i<span style="color: #a0522d;">+</span>1<span style="color: #707183;">)</span>
            <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> c2l <span style="color: #707183;">(</span>n <span style="color: #a0522d;">`div`</span> 2<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>i<span style="color: #a0522d;">+</span>1<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>maxConj</code> es el máximo número que puede pertenecer al conjunto. Depende de la
implementación de Haskell.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">maxConj</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">maxConj</span> <span style="color: #a0522d;">=</span>
  truncate <span style="color: #707183;">(</span>logBase 2 <span style="color: #7388d6;">(</span>fromIntegral maxInt<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span> <span style="color: #a0522d;">-</span> 1
  <span style="color: #a020f0;">where</span> maxInt <span style="color: #a0522d;">=</span> maxBound<span style="color: #a0522d;">::</span><span style="color: #228b22;">Int</span>
</pre>
</div></li>

<li><p>
<code>vacio</code> es el conjunto vacío.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">vacio</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Conj</span>
<span style="color: #0000ff;">vacio</span> <span style="color: #a0522d;">=</span> 0
</pre>
</div></li>

<li><p>
<code>(esVacio c)</code> se verifica si <code>c</code> es el conjunto vacío.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">esVacio</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Conj</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Bool</span>
<span style="color: #0000ff;">esVacio</span> n <span style="color: #a0522d;">=</span> n<span style="color: #a0522d;">==</span>0
</pre>
</div></li>

<li><p>
<code>(conjCompleto n)</code> es el conjunto de los números desde 1 hasta n.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">conjCompleto</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Conj</span>
<span style="color: #0000ff;">conjCompleto</span> n
  <span style="color: #a0522d;">|</span> <span style="color: #707183;">(</span>n<span style="color: #a0522d;">&gt;=</span>0<span style="color: #707183;">)</span> <span style="color: #a0522d;">&amp;&amp;</span> <span style="color: #707183;">(</span>n<span style="color: #a0522d;">&lt;=</span>maxConj<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> 2<span style="color: #a0522d;">^</span><span style="color: #707183;">(</span>n<span style="color: #a0522d;">+</span>1<span style="color: #707183;">)</span><span style="color: #a0522d;">-</span>2
  <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> error <span style="color: #707183;">(</span><span style="color: #8b2252;">"conjCompleto:"</span> <span style="color: #a0522d;">++</span> show n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(inserta x c)</code> es el conjunto obtenido añadiendo el elemento <code>x</code> al conjunto
<code>c</code>.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">inserta</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Conj</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Conj</span>
<span style="color: #0000ff;">inserta</span> i s
  <span style="color: #a0522d;">|</span> i<span style="color: #a0522d;">&gt;=</span>0 <span style="color: #a0522d;">&amp;&amp;</span> i<span style="color: #a0522d;">&lt;=</span>maxConj <span style="color: #a0522d;">=</span> d'<span style="color: #a0522d;">*</span>e<span style="color: #a0522d;">+</span>m
  <span style="color: #a0522d;">|</span> otherwise          <span style="color: #a0522d;">=</span> error <span style="color: #707183;">(</span><span style="color: #8b2252;">"inserta:"</span> <span style="color: #a0522d;">++</span> show i<span style="color: #707183;">)</span>
  <span style="color: #a020f0;">where</span> <span style="color: #707183;">(</span>d,m<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> divMod s e
        e     <span style="color: #a0522d;">=</span> 2<span style="color: #a0522d;">^</span>i
        d'    <span style="color: #a0522d;">=</span> <span style="color: #a020f0;">if</span> odd d <span style="color: #a020f0;">then</span> d <span style="color: #a020f0;">else</span> d<span style="color: #a0522d;">+</span>1
</pre>
</div></li>

<li><p>
<code>(elimina x c)</code> es el conjunto obtenido eliminando el elemento <code>x</code> del
conjunto <code>c</code>.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">elimina</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Conj</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Conj</span>
<span style="color: #0000ff;">elimina</span> i s <span style="color: #a0522d;">=</span> d'<span style="color: #a0522d;">*</span>e<span style="color: #a0522d;">+</span>m
  <span style="color: #a020f0;">where</span> <span style="color: #707183;">(</span>d,m<span style="color: #707183;">)</span> <span style="color: #a0522d;">=</span> divMod s e
        e <span style="color: #a0522d;">=</span> 2<span style="color: #a0522d;">^</span>i
        d' <span style="color: #a0522d;">=</span> <span style="color: #a020f0;">if</span> odd d <span style="color: #a020f0;">then</span> d<span style="color: #a0522d;">-</span>1 <span style="color: #a020f0;">else</span> d
</pre>
</div></li>

<li><p>
Ejemplo de grafo para el problema:
</p>
<pre class="example">
   4       5
+----- 2 -----+
|      |1     |
|  1   |   8  |
1----- 3 -----5
|        \2  /
|  6     2\ /5
+----- 4 --6
</pre></li>

<li><p>
La definición del grafo anterior es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">ej1</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span>
<span style="color: #0000ff;">ej1</span> <span style="color: #a0522d;">=</span> creaGrafo <span style="color: #228b22;">True</span> <span style="color: #707183;">(</span>1,6<span style="color: #707183;">)</span>
                     <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span>i,j,<span style="color: #909183;">(</span>v1<span style="color: #a0522d;">!!</span><span style="color: #709870;">(</span>i<span style="color: #a0522d;">-</span>1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #a0522d;">!!</span><span style="color: #909183;">(</span>j<span style="color: #a0522d;">-</span>1<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
                      <span style="color: #a0522d;">|</span> i <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span>, j <span style="color: #a0522d;">&lt;-</span> <span style="color: #7388d6;">[</span>1<span style="color: #a0522d;">..</span>6<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">v1</span> <span style="color: #a0522d;">::</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
<span style="color: #0000ff;">v1</span> <span style="color: #a0522d;">=</span> <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span>  0,  4,  1,  6,100,100<span style="color: #7388d6;">]</span>,
      <span style="color: #7388d6;">[</span>  4,  0,  1,100,  5,100<span style="color: #7388d6;">]</span>,
      <span style="color: #7388d6;">[</span>  1,  1,  0,100,  8,  2<span style="color: #7388d6;">]</span>,
      <span style="color: #7388d6;">[</span>  6,100,100,  0,100,  2<span style="color: #7388d6;">]</span>,
      <span style="color: #7388d6;">[</span>100,  5,  8,100,  0,  5<span style="color: #7388d6;">]</span>,
      <span style="color: #7388d6;">[</span>100,100,  2,  2,  5,  0<span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
</pre>
</div></li>

<li><p>
Los índices de la matriz de cálculo son de la forma <code>(i,S)</code> y sus valores
<code>(v,xs)</code> donde <code>xs</code> es el camino mínimo desde <code>i</code> hasta <code>n</code> visitando cada
vértice de <code>S</code> exactamente una vez y <code>v</code> es el coste de <code>xs</code>.
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #a020f0;">type</span> <span style="color: #228b22;">IndicePV</span> <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Conj</span><span style="color: #707183;">)</span>
<span style="color: #a020f0;">type</span> <span style="color: #228b22;">ValorPV</span>  <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(viajante g)</code> es el par <code>(v,xs)</code> donde <code>xs</code> es el camino de menor coste que
pasa exactamente una vez por todos los nodos del grafo <code>g</code> empezando en su
último nodo y <code>v</code> es su coste. Por ejemplo,
</p>
<pre class="example">
λ&gt; viajante ej1
(20,[6,4,1,3,2,5,6])
</pre>

<p>
Su definición es
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">viajante</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #7388d6;">[</span><span style="color: #228b22;">Int</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">viajante</span> g <span style="color: #a0522d;">=</span> valor t <span style="color: #707183;">(</span>n,conjCompleto <span style="color: #7388d6;">(</span>n<span style="color: #a0522d;">-</span>1<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #a020f0;">where</span> n <span style="color: #a0522d;">=</span> length <span style="color: #707183;">(</span>nodos g<span style="color: #707183;">)</span>
          t <span style="color: #a0522d;">=</span> dinamica <span style="color: #707183;">(</span>calculaPV g n<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>cotasPV n<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(calculaPV g n t (i,k))</code> es el valor del camino mínimo en el grafo <code>g</code> desde
<code>i</code> hasta <code>n</code>, calculado usando la tabla <code>t</code>, visitando cada nodo del
conjunto <code>k</code> exactamente una vez.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">calculaPV</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Grafo</span> <span style="color: #228b22;">Int</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">Tabla</span> <span style="color: #228b22;">IndicePV</span> <span style="color: #228b22;">ValorPV</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">IndicePV</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #228b22;">ValorPV</span>
<span style="color: #0000ff;">calculaPV</span> g n t <span style="color: #707183;">(</span>i,k<span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> esVacio k <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>peso i n g,<span style="color: #7388d6;">[</span>i,n<span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
  <span style="color: #a0522d;">|</span> otherwise <span style="color: #a0522d;">=</span> minimum <span style="color: #707183;">[</span>sumaPrim <span style="color: #7388d6;">(</span>valor t <span style="color: #909183;">(</span>j, elimina j k<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span>
                                  <span style="color: #7388d6;">(</span>peso i j g<span style="color: #7388d6;">)</span>
                         <span style="color: #a0522d;">|</span> j <span style="color: #a0522d;">&lt;-</span> conj2Lista k<span style="color: #707183;">]</span>
  <span style="color: #a020f0;">where</span> sumaPrim <span style="color: #707183;">(</span>v,xs<span style="color: #707183;">)</span> v' <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span>v<span style="color: #a0522d;">+</span>v',i<span style="color: #228b22;">:</span>xs<span style="color: #707183;">)</span>
</pre>
</div></li>

<li><p>
<code>(cotasPV n)</code> son las cotas de la matriz de cálculo del problema del viajante
en un grafo con <code>n</code> nodos.
</p>
<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000ff;">cotasPV</span> <span style="color: #a0522d;">::</span> <span style="color: #228b22;">Int</span> <span style="color: #a0522d;">-&gt;</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Conj</span><span style="color: #7388d6;">)</span>,<span style="color: #7388d6;">(</span><span style="color: #228b22;">Int</span>,<span style="color: #228b22;">Conj</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
<span style="color: #0000ff;">cotasPV</span> n <span style="color: #a0522d;">=</span> <span style="color: #707183;">(</span><span style="color: #7388d6;">(</span>1,vacio<span style="color: #7388d6;">)</span>,<span style="color: #7388d6;">(</span>n,conjCompleto n<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org267b9d8" class="outline-2">
<h2 id="org267b9d8"><span class="section-number-2">6.</span> Material complementario</h2>
<div class="outline-text-2" id="text-6">
<p>
El código del tema se encuentra en los siguientes enlaces
</p>
<ul class="org-ul">
<li><a href="https://github.com/jaalonso/I1M-Cod-Temas/blob/master/src/Tema_24/Dinamica.hs">Patrón de la programación dinámica</a>.</li>
<li><a href="https://github.com/jaalonso/I1M-Cod-Temas/blob/master/src/Tema_24/Fibonacci.hs">Fibonacci como ejemplo de programación dinámica</a>.</li>
<li><a href="https://github.com/jaalonso/I1M-Cod-Temas/blob/master/src/Tema_24/ProductoDeCadenaDeMatrices.hs">Producto de cadenas de matrices</a>.</li>
<li><a href="https://github.com/jaalonso/I1M-Cod-Temas/blob/master/src/Tema_24/CaminosMinimos.hs">Caminos mínimos entre todos los pares de nodos de un grafo</a>.</li>
<li><a href="https://github.com/jaalonso/I1M-Cod-Temas/blob/master/src/Tema_24/ProblemaDelViajante.hs">Problema del viajante</a>.</li>
</ul>

<p>
Este tema también se encuentra en los siguientes formatos:
</p>
<ul class="org-ul">
<li>Como <a href="./tema-24.pdf">transparencias en PDF</a>.</li>
<li>Como <a href="https://mybinder.org/v2/gh/jaalonso/Temas_interactivos_de_PF_con_Haskell/master?filepath=temas/Tema-24.ipynb">libro interactivo en IHaskell sobre Jupyter</a>.</li>
</ul>
</div>

<div id="outline-container-orgefa09a6" class="outline-3">
<h3 id="orgefa09a6"><span class="section-number-3">6.1.</span> Bibliografía</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>F. Rabhi y G. Lapalme. <a href="https://www.iro.umontreal.ca/~lapalme/Algorithms-functional.html">Algorithms: A functional programming approach</a>.
<ul class="org-ul">
<li>Cap. 9: Dynamic programming.</li>
</ul></li>
<li>T. Sutton <a href="https://speakerdeck.com/thsutton/dynamic-programming-in-haskell">Dynamic programming in Haskell</a>.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr>
<center>
<p><a href="/"><i class="fa fa-home"></i></a> |
   <a href="/curso-i1m/i1m/">Inicial</a> |
   <a href="/curso-i1m/i1m/temas_apuntes_codigos.html">Temas  </a> |
   <a href="/curso-i1m/i1m/manuales.html">Manuales  </a> |
   <a href="/curso-i1m/i1m/ejercicios.html">Ejercicios  </a> |
   <a href="/curso-i1m/i1m/examenes.html">Exámenes  </a> |
   <a href="/curso-i1m/i1m/doc.html">Documentación  </a>
</p>
</center>
<div id="extras">
  <p><a href="/">José A. Alonso Jiménez</a>
  <p>Sevilla, 28 de febrero del 2025</p>
  <p><i class="fa fa-cc"></i> Licencia: <a href="https://creativecommons.org/licenses/by-nc-sa/2.5/es/">Creative Commons</a>.</p>
</div>
</div>
</body>
</html>