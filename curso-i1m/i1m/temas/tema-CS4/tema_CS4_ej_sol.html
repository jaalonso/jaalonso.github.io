<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
 <HEAD>
  <TITLE>wxMaxima HTML export</TITLE>
  <META NAME="generator" CONTENT="wxMaxima">
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
  <STYLE TYPE="text/css">
body {
  font-family: Sans;
  background-color: rgb(255,255,255);
}
.input {
  color: rgb(0,0,255);
}
.comment {
  color: rgb(0,0,0);
  background-color: rgb(173,216,230);
  padding: 2mm;
}
.image {
  color: rgb(0,0,0);
  padding: 2mm;
}
.section {
  color: rgb(0,0,0);
  font-weight: bold;
  font-style: italic;
  font-size: 1.5em;
  padding: 2mm;
}
.subsect {
  color: rgb(0,0,0);
  font-weight: bold;
  font-size: 1.2em;
  padding: 2mm;
}
.title {
  color: rgb(0,0,0);
  font-weight: bold;
  text-decoration: underline;
  font-size: 2em;
  padding: 2mm;
}
.prompt {
  color: rgb(255,0,0);
}
  </STYLE>
 </HEAD>
 <BODY>

<!---------------------------------------------------------->
<!--          Created with wxMaxima version 0.8.4         -->
<!---------------------------------------------------------->


<!-- Title cell -->


<P CLASS="title">
Tema CS4. Sucesiones<BR>
(Soluciones de los ejercicios propuestos)
</P>


<!-- Text cell -->


<P CLASS="comment">
En esta relación se usan las siguientes funciones: define, float, <BR>
for...do, if...then...elseif...else, join, makelist, plot2d, rhs, <BR>
simplify_sum, solve, solve_rec y sum. 
</P>


<!-- Section cell -->


<P CLASS="section">
 1 Ejercicio 1
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.1. La sucesión de Fibonacci está definida como <BR>
&nbsp;&nbsp;&nbsp;F[0]   = 0,<BR>
&nbsp;&nbsp;&nbsp;F[1]   = 1, <BR>
&nbsp;&nbsp;&nbsp;F[n+2] = F[n+1]+F[n].<BR>
Definir f[n] como la sucesión de Fibonacci. 
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i1) 
  </SPAN>
  <SPAN CLASS="input">
f[0] :   0$ <BR>
f[1] :   1$<BR>
f[n] := f[n-1]+f[n-2]$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.2. Definir la lista l1 cuyos elementos son los 20 primeros<BR>
términos de la sucesión de Fibonacci.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i4) 
  </SPAN>
  <SPAN CLASS="input">
l1: makelist([n,f[n]],n,0,20);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_0.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.3. Calcular el término que ocupa la posición 20 en la sucesión<BR>
de Fibonacci. 
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i5) 
  </SPAN>
  <SPAN CLASS="input">
f[20];
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_1.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.4. Calcular el término de posición 20 de la sucesión de <BR>
Fibonacci de forma iterativa, usando sólo dos variables: a y b.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i6) 
  </SPAN>
  <SPAN CLASS="input">
a:0$<BR>
b:1$<BR>
for i:1 thru 20 do (c:a, d:b, a:d, b:c+d)$<BR>
b;
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_2.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.5. Definir la sucesión g, que calcule el término n-ésimo de <BR>
la sucesión de Fibonacci de forma iterativa, usando sólo dos variables:<BR>
a y b. Usando la función g, calcular el término de posición 20 de la <BR>
sucesión de Fibonacci.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i10) 
  </SPAN>
  <SPAN CLASS="input">
g[n]:= block ([a:0,b:1,c,d], <BR>
&nbsp;&nbsp;&nbsp;for i:1 thru n do (c:a, d:b, a:d, b:c+d),<BR>
&nbsp;&nbsp;&nbsp;a)$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i11) 
  </SPAN>
  <SPAN CLASS="input">
g[20];
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_3.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 1.6. Comprobar si se puede  obtener el término 800 de la <BR>
sucesión de Fibonacci mediante alguna de las dos funciones f ó g.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i12) 
  </SPAN>
  <SPAN CLASS="input">
g[800];
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_4.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i13) 
  </SPAN>
  <SPAN CLASS="input">
f[800];
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_5.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 2 Ejercicio 2
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.1. Definir s[n] como la suma de los n primeros términos de la<BR>
sucesión (-1)^(k+1)/k!
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i14) 
  </SPAN>
  <SPAN CLASS="input">
s[n] := sum((-1)^(k+1)/k!,k,1,n);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_6.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.2. Calcular los valores exactos de s[1], s[2], s[5] y s[9].
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i15) 
  </SPAN>
  <SPAN CLASS="input">
makelist('s[i]=s[i],i,[1,2,5,9]);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_7.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.3. Calcular los valores decimales aproximados de s[20] y s[50].
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i16) 
  </SPAN>
  <SPAN CLASS="input">
makelist('s[i]=s[i],i,[20,50]), numer;
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_8.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 2.4. Cargar el paquete simplify_sum y calcular la suma de la <BR>
serie s[n].
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i17) 
  </SPAN>
  <SPAN CLASS="input">
load(simplify_sum)$ <BR>
'sum((-1)^(k+1)/k!,k,1,inf) = simplify_sum(sum((-1)^(k+1)/k!,k,1,inf));
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_9.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 3 Ejercicio 3
</P>


<!-- Text cell -->


<P CLASS="comment">
Un banco presta un capital K al t por ciento aunual, que se reembolsa en <BR>
N años, con anualidades x constante. Sea c[0]=K y sea c[n] el capital<BR>
pendiente de pagar después de la n-ésima anualidad. Entonces,<BR>
c[n+1] = (1+t)*c[n]-x
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3.1. Expresar c[n] de manera explícita en función de n, K, t y x.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i19) 
  </SPAN>
  <SPAN CLASS="input">
load(solve_rec)$<BR>
kill(c)$<BR>
solve_rec(c[n]=(1+t)*c[n-1]-x,c[n],c[0]=K);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_10.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i22) 
  </SPAN>
  <SPAN CLASS="input">
ratsimp(%);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_11.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3.2. Se sabe que c[N]=0. Deducir el valor de x en función de<BR>
K, t y N.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i23) 
  </SPAN>
  <SPAN CLASS="input">
 define(c[n],rhs(%));
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_12.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i24) 
  </SPAN>
  <SPAN CLASS="input">
solve(c[N],x);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_13.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 3.3. Calcular el importe de una anualidad, cuando<BR>
K = 100000, t = 5,5% y  N = 15.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i25) 
  </SPAN>
  <SPAN CLASS="input">
subst([K=100000,t=5.5,N=15],%);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_14.png">
</P>


<!-- Section cell -->


<P CLASS="section">
 4 Ejercicio 4
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.1. Definir la función f(x) = x/(3-2x).
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i26) 
  </SPAN>
  <SPAN CLASS="input">
f(x) := x/(3-2*x);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_15.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.2. Definir la sucesión u[n] tal que<BR>
&nbsp;&nbsp;&nbsp;u[0]   = 2<BR>
&nbsp;&nbsp;&nbsp;u[n+1] = f(u[n]) 
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i27) 
  </SPAN>
  <SPAN CLASS="input">
u[0] : 2$<BR>
u[n] := f(u[n-1])$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.3. Calcula u[1], u[2] y u[9].
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i29) 
  </SPAN>
  <SPAN CLASS="input">
makelist('u[i]=u[i],i,[1,2,9]);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_16.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.4. Dibujar, en la misma gráfica, la función f, la recta de <BR>
ecuación y=x y los puntos de coordenada (u[k],f(u[k])) para 0<=k<=15.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i30) 
  </SPAN>
  <SPAN CLASS="input">
puntos : makelist([u[k],f(u[k])],k,0,15)$
  </SPAN>

</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i31) 
  </SPAN>
  <SPAN CLASS="input">
wxplot2d([f(x),x,[discrete,puntos]],[x,-9,9],[y,-9,9],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[style, lines,lines,linespoints],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[gnuplot_preamble, "set key left top"]);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_17.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i32) 
  </SPAN>
  <SPAN CLASS="input">
wxplot2d([f(x),x,[discrete,puntos]],[x,-3,3],[y,-3,3],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[style, lines,lines,linespoints],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[gnuplot_preamble, "set key left top"]);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_18.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i33) 
  </SPAN>
  <SPAN CLASS="input">
wxplot2d([f(x),x,[discrete,puntos]],[x,-0.5,0.5],[y,-0.5,0.5],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[style, lines,lines,linespoints],<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[gnuplot_preamble, "set key left top"]);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_19.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.4. Conjeturar la monotonía de la sucesión u[n] y su limite.
</P>


<!-- Text cell -->


<P CLASS="comment">
Solución: La sucesión u[n] es monótona decreciente y su límite es 0.
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.5. Resolver la ecuación f(x)=x. Llamar a las raices a y b.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i34) 
  </SPAN>
  <SPAN CLASS="input">
solve(f(x)=x,x);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_20.png">
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i35) 
  </SPAN>
  <SPAN CLASS="input">
a:0$ b:1$
  </SPAN>

</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.6. Definir la sucesión w[n] = (u[n]-a)/(u[n]-b)
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i37) 
  </SPAN>
  <SPAN CLASS="input">
w[n] := (u[n]-a)/(u[n]-b);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_21.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.7. Calcular los 10 primeros términos de la sucesión w[n].
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i38) 
  </SPAN>
  <SPAN CLASS="input">
makelist(w[n],n,0,9);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_22.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.8. Comprobar que w[n] es una progresión geométrica y calcular<BR>
su razón.
</P>


<!-- Text cell -->


<P CLASS="comment">
Solución: se observa que w[n] es la progresión geométrica de término <BR>
inicial 2 y razón 1/3.
</P>


<!-- Text cell -->


<P CLASS="comment">
Ejercicio 4.9. Deducir la expresión de u[n] en función de n.
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i39) 
  </SPAN>
  <SPAN CLASS="input">
solve((x-a)/(x-b)=2/3^n,x);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_23.png">
</P>


<!-- Text cell -->


<P CLASS="comment">
Por tanto, u[n] = -2/(3^n-2). Puede comprobarse como sigue
</P>


<!-- Code cell -->


<P>
  <SPAN CLASS="prompt">
(%i40) 
  </SPAN>
  <SPAN CLASS="input">
makelist([u[n],-2/(3^n-2)],n,0,5);
  </SPAN>
  <BR>
  <IMG ALT="Result" SRC="tema_CS4_ej_sol_img/tema_CS4_ej_sol_24.png">
</P>

 <HR>
 <SMALL> Created with <A HREF="http://wxmaxima.sourceforge.net/">wxMaxima</A>.</SMALL>

 </BODY>
</HTML>
